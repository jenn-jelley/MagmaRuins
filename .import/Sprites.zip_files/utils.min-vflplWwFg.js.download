define(["require","exports","tslib","modules/clean/open_with","modules/clean/file_store/utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/types","modules/clean/react/file_viewer/unity/unity_utils","modules/clean/react/file_viewer/open_with_helpers","modules/clean/react/paper/utils","modules/clean/react/file_viewer/data/actions","modules/core/i18n","modules/clean/react/extensions/utils","modules/clean/cloud_docs/open_with_utils"],function(e,n,t,i,r,o,s,l,u,a,p,c,d,f){"use strict";function _(e){var n=e.file,i=t.__rest(e,["file"]);return r.isBrowseFile(n)?O(t.__assign({file:n},i)):r.isSharedFile(n)?h(t.__assign({file:n},i)):[]}function h(e){for(var n=e.file,t=e.user,i=e.isOpenWithDisabled,r=[],o={gdd:!e.isCloudEditorDisabled,wopi:A({file:n,isOpenWithDisabled:i,user:t})},s=e.actionSource,l=f.getOpenWithCloudEditorInfo(n,t,o,s),u=function(e){r.push({handler:function(){return e.handler(n,t,s)},spriteName:e.spriteName||null,iconUrl:e.iconUrl,text:e.text,type:e.type,userAction:e.userAction})},a=0,p=l;a<p.length;a++){u(p[a])}return r}function O(e){var n=e.file,t=e.hasOpenInPaperSupport,i=e.isUnityDisabled,r=e.isOpenWithDisabled,l=e.isCloudEditorDisabled,a=e.unityInfo,_=e.extraOptions,h=e.user,O=e.sharingServiceInfo,S=e.refreshSharingServiceInfo,D=e.showOpenWithShare,N=e.onPresentInZoom,F=e.isCloudBasedDoc,W=e.actionSource;if(!a)return[];var E=[];t&&E.push({handler:b({file:n,user:h}),spriteName:"paper",text:c._("Copy to Paper"),type:s.OpenButtonAction.OPEN_IN_PAPER,userAction:o.UserAction.CopyToPaper}),!F&&y({isUnityDisabled:i,unityInfo:a})&&E.push({handler:I({file:n,user:h,isFolder:!1}),spriteName:"ow_desktop",text:v(a),type:s.OpenButtonAction.UNITY_FILE,userAction:o.UserAction.OpenInUnity});var g=A({file:n,isOpenWithDisabled:r,user:h}),x=u.OpenWithHelpers.getOpenWithHandlerData(n,h),P=f.isSingleFileEditingForWopiEnabled(h.id);g&&x&&!P&&E.push({handler:U({file:n,user:h}),spriteName:x.icon,text:x.name,type:s.OpenButtonAction.OPEN_WITH,userAction:o.UserAction.OpenInOfficeOnline});for(var B={gdd:!l,wopi:g},H=f.getOpenWithCloudEditorInfo(n,h,B,W),C=function(e){E.push({handler:function(){return e.handler(n,h,W)},spriteName:e.spriteName||null,iconUrl:e.iconUrl,text:e.text,type:e.type,userAction:e.userAction})},T=0,k=H;T<k.length;T++){C(k[T])}m({isUnityDisabled:i,unityInfo:a})&&E.push({handler:I({file:n,user:h,isFolder:!0}),spriteName:"ow_folder",text:w(a),type:s.OpenButtonAction.UNITY_FOLDER,userAction:o.UserAction.OpenInUnityFolder}),_&&_.forEach(function(e){e&&E.push(e)}),E.length||F||E.push({handler:function(){return p.download(n)},spriteName:null,text:c._("Download"),type:s.OpenButtonAction.DOWNLOAD,userAction:o.UserAction.Download});var Z=!1,L=!1;return D&&O&&(Z=d.isSlackAvailable(O),L=d.isZoomAvailable(O)),Z&&O&&S&&E.push({handler:function(){return d.shareInSlackFlow(h,O,S,n,"open_with_button")},spriteName:null,text:c._("Slack"),type:s.OpenButtonAction.SHARE_TO_SLACK,userAction:o.UserAction.ShareToSlack}),L&&O&&N&&S&&E.push({handler:function(){return d.presentInZoomFlow(h,O,S,n,N,"open_with_button")},spriteName:null,text:c._("Zoom"),type:s.OpenButtonAction.PRESENT_IN_ZOOM,userAction:o.UserAction.PresentInZoom}),E}function m(e){var n=e.isUnityDisabled,t=e.unityInfo;return!n&&l.UnityHelpers.isUnityFolderSupported(t)}function y(e){var n=e.isUnityDisabled,t=e.unityInfo;return!n&&l.UnityHelpers.isUnityFileSupported(t)}function A(e){var n=e.file,t=e.isOpenWithDisabled,i=e.user;return!t&&u.OpenWithHelpers.canOpenWith(n,i)}function v(e){var n=(e?e.open_application_name:void 0)||c._("Desktop");return c._("Open in %(app_name)s").format({app_name:n})}function w(e){var n=(null!==e?e.file_browser_display_name:void 0)||c._("File Browser");return c._("Show in %(file_browser)s").format({file_browser:n})}function I(e){var n=e.file,t=e.isFolder,i=e.user;return function(){l.UnityHelpers.openFile(n.ns_id,n.ns_path,i.id,t)}}function U(e){var n=e.file,t=e.user;return function(){u.OpenWithHelpers.openWith(n,t)}}function b(e){var n=e.file,t=e.user;return function(){a.openFileInPaper({file:n,user:t})}}function S(e,n){var t=e.map(function(e){return e.type}).includes(s.OpenButtonAction.UNITY_FILE),r=n&&i.default.is_adobe_app(n.open_application_identifier),o=e.map(function(e){return e.type}).includes(s.OpenButtonAction.OPEN_WITH);return t&&r||o}Object.defineProperty(n,"__esModule",{value:!0}),i=t.__importDefault(i),n.getOpenOptions=_,n.getOpenOptionsSharedFile=h,n.shouldShowCoachmark=S});
//# sourceMappingURL=utils.min.js-vflSwucNu.map