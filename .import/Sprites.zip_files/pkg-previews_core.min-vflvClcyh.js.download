define("file-viewer/assets-metaserver",["require","exports","modules/clean/static_urls"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assets={"2NQat":r.static_url("/static/js/file-viewer/img/error/unavailable_1x-vflG2AHMd.png"),"1M0Da":r.static_url("/static/js/file-viewer/img/error/unavailable_2x-vflGPrE5d.png"),"3_SVR":r.static_url("/static/js/file-viewer/img/error/file_too_large_1x-vflDGNPuo.png"),"1KZOf":r.static_url("/static/js/file-viewer/img/error/file_too_large_2x-vfl-r0UPt.png"),d7hcI:r.static_url("/static/js/file-viewer/img/error/file_uploading_1x-vflRuLSg0.png"),"1WylU":r.static_url("/static/js/file-viewer/img/error/file_uploading_2x-vflKOdrWj.png"),"1j0Ik":r.static_url("/static/js/file-viewer/img/error/filetype_not_supported_1x-vflmIVODZ.png"),"3afH2":r.static_url("/static/js/file-viewer/img/error/filetype_not_supported_2x-vflE8HW8X.png"),"32YjM":r.static_url("/static/js/file-viewer/img/error/password_protected_1x-vflnFAKjt.png"),"29R06":r.static_url("/static/js/file-viewer/img/error/password_protected_2x-vflnBXZ1k.png")}}),define("file-viewer/core/bootstrap",["require","exports","tslib","redux","file-viewer/core/data/reducer","file-viewer/core/data/actions","file-viewer/core/urls","file-viewer/core/uuid","modules/clean/api_v2/redux/previews","file-viewer/core/middlewares/riviera_data","file-viewer/core/utils","file-viewer/core/config","file-viewer/core/middlewares/analytics","file-viewer/core/logging/actions","file-viewer/core/extension_constants","file-viewer/core/middlewares/ui_action_redispatcher","modules/clean/api_v2/redux/users"],function(e,t,r,i,n,a,o,s,l,c,u,d,p,f,v,_,m){"use strict";function g(e){var t=s.v4(),i=e.store,n=e.intl,c=e.config,d=e.resolveAsset;return i.dispatch(a.initializeFileViewerUi(t)),i.dispatch(m.getCurrentAccountAction({arg:void 0})),{id:t,getPlatformProps:function(){return{intl:n,store:i,config:c,resolveAsset:d,accountId:e.accountId,deviceType:e.deviceType}},setCurrentFileIdOrRevisionId:function(e){i.dispatch(a.setCurrentFilePreview({fileViewerId:t,fileIdOrRevisionId:e}))},loadFilePreview:function(n){return r.__awaiter(this,void 0,void 0,function(){var s,c,d,p,_;return r.__generator(this,function(r){return s=n.fileId,c=n.fileName,d=n.sourceSession,p=u.getFileExtension(c),_=v.resolvePreviewType(p),i.dispatch(a.initializeFilePreview({fileViewerId:t,fileIdOrRevisionId:s,deviceType:e.deviceType||"desktop",fileExtension:p,sourceSession:d})),i.dispatch(f.logEvent({event:"preview_attempted",fileViewerId:t})),"other"===_?[2,i.dispatch(f.logEvent({event:"support_denied",fileViewerId:t}))]:(i.dispatch(f.logEvent({event:"support_confirmed",fileViewerId:t})),i.dispatch(f.logEvent({event:"download_attempted",fileViewerId:t})),[2,i.dispatch(l.getPreviewDataByFileIdsBatchAction({arg:{file_ids:[s]}})).then(function(){var e=i.getState().previewData[s];if(!e||!e.content)throw new Error("Failed to fetch preview data");var t=[];switch(e.content[".tag"]){case"ssr_doc":var r=e.content,n=r.text_url_tmpl,l=r.image_url_tmpl;t.push(i.dispatch(a.fetchDocMetadataAction(s,n))),i.dispatch(a.fetchDataForPageAction(s,n,0,50)),i.dispatch(a.prewarmUnifiedPreviewAsset(o.imageUrl(l,{page:0,scale_percent:0})))}return Promise.all(t)}).then(function(){return i.dispatch(f.logEvent({event:"download_succeeded",fileViewerId:t}))},function(){return i.dispatch(f.logEvent({event:"download_failed",fileViewerId:t}))})])})})}}}function w(e){var t=e.additionalMiddlewares,a=void 0===t?[]:t,o=e.initialState,s=e.additionalReducers,f=void 0===s?{}:s,v=e.assets,w=e.intl,h=e.logger,b=[c.rivieraDataMiddleware(e.rivieraIOClient),l.middleware(e.apiv2ClientBase.ns("previews")),m.middleware(e.apiv2ClientBase.ns("users")),_.uiActionRedispatcher].concat(a,h?[p.analyticsMiddleware(h)]:[]),y="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?i.compose(i.applyMiddleware.apply(void 0,b),window.__REDUX_DEVTOOLS_EXTENSION__()):i.applyMiddleware.apply(void 0,b),A=r.__assign({},n.reducers,f),P=i.createStore(i.combineReducers(A),o,y),F=d.DEFAULT_CONFIG;return e.config&&(F=r.__assign({},F,e.config)),{createFileViewer:function(){return g({intl:w,store:P,config:F,resolveAsset:u.resolveAsset.bind(null,v),accountId:e.accountId,deviceType:e.deviceType})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFileViewerSDK=w}),define("file-viewer/core/config",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CONFIG={pdf_size_limit:524288e3,ppt_size_limit:301989888,word_doc_size_limit:167772160,archive_size_limit:1073741824,text_size_limit:8388608,linkfile_size_limit:10240,load_image_only:!1}}),define("file-viewer/core/data/actions",["require","exports"],function(e,t){"use strict";function r(e,t,r,i){return{payload:{fileIdOrRevisionId:e,textUrlTmpl:t,pageLowerBound:r,pageUpperBound:i},type:"@@previews/fetchDataForPage"}}function i(e,t,r){return{payload:{fileIdOrRevisionId:e,data:t},type:"@@previews/fetchDataForPageResult",error:r}}function n(e,t){return{payload:{fileIdOrRevisionId:e,textUrlTmpl:t},type:"@@previews/fetchDocMetadata"}}function a(e,t,r){return{type:"@@previews/fetchDocMetadataResult",payload:{fileIdOrRevisionId:e,data:t},error:r}}function o(e){return{payload:e,type:"@@previews/refreshBlob"}}function s(e){return{payload:e,type:"@@previews/refreshBlobSuccess"}}function l(e){return{type:"@@previews/fetchUnifiedPreviewAsset",payload:{assetUrl:e}}}function c(e){return{type:"@@previews/updateDocCurrentPageIndex",payload:e}}function u(e){return{type:"@@previews/zoomIn",payload:e}}function d(e){return{type:"@@previews/zoomOut",payload:e}}function p(e){return{type:"@@previews/updateMinScaleFactor",payload:e}}function f(e){return{type:"@@previews/zoomOriginalOrFit",payload:e}}function v(e){return{type:"@@previews/fileViewerUi/initialize",payload:{fileViewerId:e}}}function _(e){return{type:"@@previews/initializeFilePreview",payload:e}}function m(e){return{type:"@@previews/fileViewerUi/openDocSidebar",payload:e}}function g(e){return{type:"@@previews/fileViewerUi/closeDocSidebar",payload:e}}function w(e){return{type:"@@previews/setCurrentFilePreview",payload:e}}function h(e){return{type:"@@previews/updateScaleFactor",payload:e}}function b(e){return{type:"@@previews/pageDown",payload:e}}function y(e){return{type:"@@previews/pageUp",payload:e}}function A(e){return{type:"@@previews/modes/changeMode",payload:e}}function P(e){return{payload:e,type:"@@previews/sidebarControlClick"}}function F(e){return{payload:e,type:"@@previews/setSidebarVisibility"}}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.ChangeMode="@@previews/modes/changeMode",e.CloseDocSidebar="@@previews/fileViewerUi/closeDocSidebar",e.FetchDataForPage="@@previews/fetchDataForPage",e.FetchDataForPageResult="@@previews/fetchDataForPageResult",e.FetchDocMetadata="@@previews/fetchDocMetadata",e.FetchDocMetadataResult="@@previews/fetchDocMetadataResult",e.FetchPhotoMetadataResult="@@previews/fetchPhotoMetadataResult",e.InitializeFilePreview="@@previews/initializeFilePreview",e.InitializeFileViewerUi="@@previews/fileViewerUi/initialize",e.OpenDocSidebar="@@previews/fileViewerUi/openDocSidebar",e.PageDown="@@previews/pageDown",e.PageUp="@@previews/pageUp",e.PrewarmUnifiedPreviewAsset="@@previews/fetchUnifiedPreviewAsset",e.RefreshBlob="@@previews/refreshBlob",e.RefreshBlobSuccess="@@previews/refreshBlobSuccess",e.SetCurrentFilePreview="@@previews/setCurrentFilePreview",e.UpdateDocCurrentPageIndex="@@previews/updateDocCurrentPageIndex",e.UpdateMinScaleFactor="@@previews/updateMinScaleFactor",e.UpdateScaleFactor="@@previews/updateScaleFactor",e.ZoomIn="@@previews/zoomIn",e.ZoomOriginalOrFit="@@previews/zoomOriginalOrFit",e.ZoomOut="@@previews/zoomOut",e.SidebarControlClick="@@previews/sidebarControlClick",e.SetSidebarVisibility="@@previews/setSidebarVisibility"})(t.Action||(t.Action={})),t.fetchDataForPageAction=r,t.fetchDataForPageResultAction=i,t.fetchDocMetadataAction=n,t.fetchDocMetadataResultAction=a,t.refreshBlobAction=o,t.refreshBlobSuccessAction=s,t.prewarmUnifiedPreviewAsset=l,t.updateDocCurrentPageIndex=c,t.zoomIn=u,t.zoomOut=d,t.updateMinScaleFactor=p,t.zoomOriginalOrFit=f,t.initializeFileViewerUi=v,t.initializeFilePreview=_,t.openDocSidebar=m,t.closeDocSidebar=g,t.setCurrentFilePreview=w,t.updateScaleFactor=h,t.pageDown=b,t.pageUp=y,t.changeMode=A,t.sidebarControlClickAction=P,t.setSidebarVisibilityAction=F}),define("file-viewer/core/data/models",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.Archive="archive",e.Audio="audio",e.CloudDoc="cloud_doc",e.Excel="excel",e.HTML="html",e.Image="image",e.Linkfile="linkfile",e.Other="other",e.SsrDoc="ssr_doc",e.RawHTML="raw_html",e.Restricted="restricted",e.Video="video",e.Doc="doc",e.Photo="photo",e.Text="text"})(t.PreviewType||(t.PreviewType={}))}),define("file-viewer/core/data/modes/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.Closed="closed",e.Open="open"})(t.SidebarVisibility||(t.SidebarVisibility={})),(function(e){e.Documentation="documentation",e.Comments="comments",e.Watermark="watermark"})(t.SidebarControlId||(t.SidebarControlId={})),(function(e){e.Documentation="documentation",e.Metadata="metadata",e.Comments="comments",e.Activity="activity"})(t.SidebarPaneId||(t.SidebarPaneId={})),(function(e){e.Default="default",e.Commenting="commenting",e.Documentation="documentation",e.Watermarking="watermarking"})(t.FileViewerMode||(t.FileViewerMode={}))}),define("file-viewer/core/data/reducer",["require","exports","tslib","file-viewer/core/extension_constants","file-viewer/core/logging/session","file-viewer/core/uuid","file-viewer/core/data/modes/types"],function(e,t,r,i,n,a,o){"use strict";function s(e,t,r){if(1===t||!e)return 1;var i=.05*Math.round(e*t/.05);return Math.abs(i-e)<.05&&(i+=t>1?.05:-.05),Math.min(Math.max(i,r),16)}function l(e,t){return Math.max(Math.min(e*t,10),.1)}Object.defineProperty(t,"__esModule",{value:!0});var c;t.DEFAULT_USER={locale:"en",referral_link:"",is_paired:!1,account_type:{".tag":"basic"},uid:0,user_name:"",root_info:{".tag":"user"},is_deferred_password:!1,is_deferred_password_set:!1,is_business_domain:!1,is_paid:!1,has_ever_linked_desktop:!1,has_user_added_files:!1,video_uploads_enabled_default:!1,email_verified:!1,visibility_quota_info:{normal:0,shared:0,quota:0},pending_forced_migration:!1,referral_bonus_info:{bonus_space:0,max_num_bonus:0},quota_info:{normal:0,shared:0,quota:0},account_id:"",disabled:!1,email:"",role:"",teams_member:!1,name:{given_name:"",surname:"",display_name:"",familiar_name:"",abbreviated_name:""}},t.DEFAULT_MODE={mode:o.FileViewerMode.Default,sidebar:{visibility:o.SidebarVisibility.Closed,paneStack:[]}},t.DEFAULT_STATE={previewData:{},fileMetadata:{},rivieraData:{},fileViewerUi:{},currentFilePreviewId:{},loggingSession:{},users:{},currentUser:t.DEFAULT_USER,modes:{}},t.DEFAULT_FILE_PREVIEW_UI={isDocSidebarOpen:!1,scaleFactor:void 0,minScaleFactor:0,currentPageIndex:0,isSidebarOpen:!1};var u=function(e,i){void 0===e&&(e=t.DEFAULT_STATE.previewData);var n,a;switch(i.type){case"@@previews/initializeFilePreview":return e[i.payload.fileIdOrRevisionId]?e:r.__assign({},e,(n={},n[i.payload.fileIdOrRevisionId]={},n));case"@@apiv2_redux/previews/get_preview_data_by_file_ids_batch_result":if(!i.payload||!i.payload.result)return e;var o=i.payload.result.preview_data;return r.__assign({},e,o.reduce(function(e,t){return t.preview&&(e[t.file_id]=t.preview),e},{}));case"@@previews/refreshBlobSuccess":if(!i.payload)return e;var s=i.payload,l=s.fileIdOrRevisionId,c=s.preview,u=e[l]?e[l].content:{};return r.__assign({},e,(a={},a[l]=r.__assign({},e[l],{content:r.__assign({},u,c)}),a))}return e},d=function(e,i){void 0===e&&(e=t.DEFAULT_STATE.fileMetadata);var n;return i.payload&&"@@previews/initializeFilePreview"===i.type?e[i.payload.fileIdOrRevisionId]?e:r.__assign({},e,(n={},n[i.payload.fileIdOrRevisionId]={file_id:i.payload.fileIdOrRevisionId,file_name:""},n)):e};t.DEFAULT_DOC_PREVIEW_METADATA={metadata:{page_count:0,dimensions:[[0,0,0]]},pages:[]};var p=function(e,i){void 0===e&&(e=t.DEFAULT_STATE.rivieraData);var n,a,o,s,l,c=i.payload,u=i.error;if(!c)return e;var d=c.fileIdOrRevisionId;switch(i.type){case"@@previews/initializeFilePreview":return e[i.payload.fileIdOrRevisionId]?e:r.__assign({},e,(n={},n[i.payload.fileIdOrRevisionId]={},n));case"@@previews/fetchPhotoMetadataResult":return r.__assign({},e,(a={},a[d]={originalWidth:i.payload.originalWidth,originalHeight:i.payload.originalHeight},a));case"@@previews/fetchDocMetadataResult":return!i.payload.data||u?r.__assign({},e,(o={},o[d]=r.__assign({},t.DEFAULT_DOC_PREVIEW_METADATA,{error:i.error}),o)):r.__assign({},e,(s={},s[d]=i.payload.data,s));case"@@previews/fetchDataForPageResult":var p=e[d]||t.DEFAULT_DOC_PREVIEW_METADATA,f=p.metadata,v=p.pages;if(i.payload.data){var _=i.payload.data,m=_.metadata,g=_.pages,w=f;m&&(w=r.__assign({},f,m));var h=v||new Array(w.page_count);return Array.isArray(g)&&g.length&&(h=h.slice(),g.forEach(function(e){return h[e.pageIndex]=e})),r.__assign({},e,(l={},l[d]={metadata:w,pages:h},l))}}return e},f=function(e,n){void 0===e&&(e=t.DEFAULT_STATE.fileViewerUi);var a,o,c,u,d,p,f,v,_,m,g,w,h,b,y,A,P,F,S,x,I;if(!n.payload)return e;if("@@previews/fileViewerUi/initialize"===n.type)return r.__assign({},e,(a={},a[n.payload.fileViewerId]={},a));var R=n.payload,D=R.fileViewerId,M=R.fileIdOrRevisionId,C=e[D]||{},E=C[M]||{},O=E.scaleFactor,T=void 0===O?1:O;switch(n.type){case"@@previews/initializeFilePreview":return r.__assign({},e,(o={},o[D]=r.__assign({},C,(c={},c[M]=r.__assign({},E,{isDocSidebarOpen:i.PRESENTATION_EXTS.includes(n.payload.fileExtension),scaleFactor:void 0,minScaleFactor:0,currentPageIndex:0,isSidebarOpen:!1}),c)),o));case"@@previews/updateDocCurrentPageIndex":return r.__assign({},e,(u={},u[D]=r.__assign({},C,(d={},d[M]=r.__assign({},E,{currentPageIndex:n.payload.pageIndex}),d)),u));case"@@previews/pageUp":return r.__assign({},e,(p={},p[D]=r.__assign({},C,(f={},f[M]=r.__assign({},E,{currentPageIndex:Math.max(E.currentPageIndex-1,0)}),f)),p));case"@@previews/pageDown":return r.__assign({},e,(v={},v[D]=r.__assign({},C,(_={},_[M]=r.__assign({},E,{currentPageIndex:Math.min(E.currentPageIndex+1,n.payload.pageCount||1)}),_)),v));case"@@previews/zoomIn":return r.__assign({},e,(m={},m[D]=r.__assign({},C,(g={},g[M]=r.__assign({},E,{scaleFactor:"ssr_doc"===n.payload.previewType?l(T,1.1):s(T||E.minScaleFactor,1.25,E.minScaleFactor)}),g)),m));case"@@previews/zoomOut":return r.__assign({},e,(w={},w[D]=r.__assign({},C,(h={},h[M]=r.__assign({},E,{scaleFactor:"ssr_doc"===n.payload.previewType?l(T,1/1.1):s(T||E.minScaleFactor,.8,E.minScaleFactor)}),h)),w));case"@@previews/zoomOriginalOrFit":return r.__assign({},e,(b={},b[D]=r.__assign({},C,(y={},y[M]=r.__assign({},E,{scaleFactor:T===E.minScaleFactor?1:E.minScaleFactor}),y)),b));case"@@previews/updateMinScaleFactor":return r.__assign({},e,(A={},A[D]=r.__assign({},C,(P={},P[M]=r.__assign({},E,{minScaleFactor:n.payload.minScaleFactor}),P)),A));case"@@previews/fileViewerUi/openDocSidebar":return r.__assign({},e,(F={},F[D]=r.__assign({},C,(S={},S[M]=r.__assign({},E,{isDocSidebarOpen:!0}),S)),F));case"@@previews/fileViewerUi/closeDocSidebar":return r.__assign({},e,(x={},x[D]=r.__assign({},C,(I={},I[M]=r.__assign({},E,{isDocSidebarOpen:!1}),I)),x))}return e};t.loggingSessionReducer=function(e,i){void 0===e&&(e=t.DEFAULT_STATE.loggingSession);var o,s;if("@@previews/initializeFilePreview"===i.type){var l=i.payload,c=l.fileViewerId,u=l.sourceSession;return r.__assign({},e,(o={},o[c]=n.createFilePreviewSession({file_viewer_session_id:i.payload.fileViewerId,file_preview_session_id:a.v4(),file_id:i.payload.fileIdOrRevisionId,device_type:i.payload.deviceType,file_extension:i.payload.fileExtension,extra:u}),o))}return"@@previews/updateSession"===i.type?r.__assign({},e,(s={},s[i.payload.file_viewer_session_id]=i.payload,s)):e},t.currentFilePreviewIdReducer=function(e,i){void 0===e&&(e=t.DEFAULT_STATE.currentFilePreviewId);var n;return"@@previews/setCurrentFilePreview"!==i.type?e:r.__assign({},e,(n={},n[i.payload.fileViewerId]=i.payload.fileIdOrRevisionId,n))};var v=function(e,r){return void 0===e&&(e=t.DEFAULT_STATE.currentUser),"@@apiv2_redux/users/get_current_account_result"===r.type&&r.payload.result?r.payload.result:e};t.usersReducer=function(e,i){return void 0===e&&(e=t.DEFAULT_STATE.users),"@@apiv2_redux/users/get_account_batch_result"===i.type&&i.payload.result?r.__assign({},e,i.payload.result.reduce(function(e,t){return e[t.account_id]=t,e},{})):e};var _={visibility:o.SidebarVisibility.Closed,paneStack:[]},m=function(e){return r.__assign({},e,{sidebar:r.__assign({},e.sidebar,{visibility:e.sidebar.visibility===o.SidebarVisibility.Open?o.SidebarVisibility.Closed:o.SidebarVisibility.Open})})},g=(c={},c[o.FileViewerMode.Default]=function(e){return e.mode===o.FileViewerMode.Default?e:r.__assign({},e,{mode:o.FileViewerMode.Default})},c[o.FileViewerMode.Documentation]=function(e){return e.mode===o.FileViewerMode.Documentation?m(e):r.__assign({},e,{mode:o.FileViewerMode.Documentation,sidebar:r.__assign({},e.sidebar,{paneStack:[o.SidebarPaneId.Documentation],selectedControlId:o.SidebarControlId.Documentation,visibility:o.SidebarVisibility.Open})})},c[o.FileViewerMode.Commenting]=function(e){return e.mode===o.FileViewerMode.Commenting?m(e):r.__assign({},e,{mode:o.FileViewerMode.Commenting,sidebar:r.__assign({},e.sidebar,{paneStack:[o.SidebarPaneId.Comments],selectedControlId:o.SidebarControlId.Comments,visibility:o.SidebarVisibility.Open})})},c[o.FileViewerMode.Watermarking]=function(e){return e.mode===o.FileViewerMode.Watermarking?e:r.__assign({},e,{mode:o.FileViewerMode.Watermarking})},c);t.modesReducer=function(e,i){void 0===e&&(e=t.DEFAULT_STATE.modes);var n,a,s;if("@@previews/fileViewerUi/initialize"===i.type)return r.__assign({},e,(n={},n[i.payload.fileViewerId]={mode:o.FileViewerMode.Default,sidebar:_},n));if("@@previews/setSidebarVisibility"===i.type){var l=i.payload,c=l.fileViewerId,u=l.visibility;return r.__assign({},e,(a={},a[c]=r.__assign({},e[c],{sidebar:r.__assign({},e[c].sidebar,{visibility:u})}),a))}if("@@previews/modes/changeMode"===i.type){var d=g[i.payload.mode](e[i.payload.fileViewerId]);if(d!==e[i.payload.fileViewerId])return r.__assign({},e,(s={},s[i.payload.fileViewerId]=d,s))}return e},t.reducers={modes:t.modesReducer,previewData:u,fileMetadata:d,rivieraData:p,fileViewerUi:f,loggingSession:t.loggingSessionReducer,currentFilePreviewId:t.currentFilePreviewIdReducer,users:t.usersReducer,currentUser:v}}),define("file-viewer/core/data/riviera/api",["require","exports","tslib"],function(e,t,r){"use strict";function i(e,t,r){return 401===e&&r?new a("Password required",12):new a("Load Error",t.rivieraStatusCode)}function n(e,t,r,i,n){void 0===r&&(r=0),void 0===i&&(i=50),void 0===n&&(n=!1);var a=new URL(e);return t&&a.searchParams.set("metadata","1"),void 0!==r&&(a.searchParams.set("text","1"),a.searchParams.set("page_start",r.toString()),a.searchParams.set("page_end",i.toString())),n&&a.searchParams.set("canned_file_name","spdf/audi.pdf.json"),a.toString()}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(t,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.statusCode=r,i}return r.__extends(t,e),t})(Error);t.RivieraError=a;var o=function(e){var t={};try{e&&(t=JSON.parse(e))}catch(e){}return t};t.textUrl=n;var s=(function(){function e(){}return e.prototype.refreshDocBlob=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var i,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return i=t?{password:t}:{},[4,fetch(e,{headers:{"content-type":"application/json"},body:JSON.stringify(i),credentials:"include",method:"POST"})];case 1:return n=r.sent(),[4,n.json()];case 2:return a=r.sent(),[2,{ok:n.ok,status:n.status,data:a,headers:{"x-dropbox-metadata":n.headers.get("x-dropbox-metadata"),"x-dropbox-pdf-password-needed":n.headers.get("x-dropbox-pdf-password-needed")}}]}})})},e.prototype.fetchDocMetadata=function(e,t,i,a,o){return r.__awaiter(this,void 0,void 0,function(){var s,l;return r.__generator(this,function(r){switch(r.label){case 0:return[4,fetch(n(e,t,i,a,o),{headers:{"content-type":"application/json"},credentials:"include",method:"POST"})];case 1:return s=r.sent(),[4,s.json()];case 2:return l=r.sent(),[2,{ok:s.ok,status:s.status,data:l,headers:{"x-dropbox-metadata":s.headers.get("x-dropbox-metadata"),"x-dropbox-pdf-password-needed":s.headers.get("x-dropbox-pdf-password-needed")}}]}})})},e})();t.WebRivieraIOClient=s;var l=(function(){function e(e){this.ioClient=e}return e.prototype.refreshDocBlob=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,s,l,c,u,d,p,f,v;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.ioClient.refreshDocBlob(e,t)];case 1:if(n=r.sent(),a=n.data,s=n.status,l=n.ok,c=n.headers,!l)throw u="1"===c["x-dropbox-pdf-password-needed"],d=o(c["x-dropbox-metadata"]),i(s,d,u);return p=a.text,f=a.image,v=a.refresh,[2,{text_url_tmpl:p,image_url_tmpl:f,refresh_url:v}]}})})},e.prototype.fetchDocMetadata=function(e,t,n,a,s){return void 0===t&&(t=!1),void 0===n&&(n=0),void 0===a&&(a=50),void 0===s&&(s=!1),r.__awaiter(this,void 0,void 0,function(){var l,c,u,d,p,f,v;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this.ioClient.fetchDocMetadata(e,t,n,a,s)];case 1:if(l=r.sent(),c=l.ok,u=l.data,d=l.status,p=l.headers,c)return[2,u];throw f="1"===p["x-dropbox-pdf-password-needed"],v=o(p["x-dropbox-metadata"]),i(d,v,f)}})})},e})();t.RivieraClientBase=l}),define("file-viewer/core/data/riviera",["require","exports","file-viewer/core/data/riviera/api","file-viewer/core/data/riviera/transform","file-viewer/core/data/riviera/types"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RivieraError=r.RivieraError,t.RivieraClientBase=r.RivieraClientBase,t.WebRivieraIOClient=r.WebRivieraIOClient,t.processTextResponse=i.processTextResponse,t.RivieraStatus=n.RivieraStatus}),define("file-viewer/core/data/riviera/transform",["require","exports","tslib","file-viewer/core/urls"],function(e,t,r,i){"use strict";function n(e){var t=e.n.lastIndexOf(",");return{fontFamily:'"'+(t>-1?e.n.substr(0,t):e.n)+'", '+(1&e.f?"monospace":"serif"),isBold:(e.f&1<<18)>0,isItalic:(64&e.f)>0}}function a(e,t,a){var o=t.text,s=t.metadata||a;if(!o||!o.pages||!s)return{metadata:void 0,pages:[]};var l=o.links,c=o.pages,u=(o.fonts||[]).reduce(function(e,t){return e[t.f]=n(t),e},{}),d=s.dimensions.reduce(function(e,t){for(var r=t[0],i=t[1],n=t[2],a=0;a<n;a++)e.push([r,i]);return e},[]);return{metadata:t.metadata,pages:Object.keys(c).map(function(t){var n=c[t]||[],a=n.map(function(e){return r.__assign({},e,{font:u[e.f]})}),o=+t;return{pageIndex:o,dimension:d[o],thumbnailUrl:i.imageUrl(e,{page:o,scale_percent:0}),imgUrls:{"1x":i.imageUrl(e,{page:o,scale_percent:0}),"4x":i.imageUrl(e,{page:o,scale_percent:400})},textboxes:a,links:l&&l[o]||[]}})}}Object.defineProperty(t,"__esModule",{value:!0});t.processTextResponse=a}),define("file-viewer/core/data/riviera/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.Unknown=0]="Unknown",e[e.OK=1]="OK",e[e.ConversionFailure=2]="ConversionFailure",e[e.TemporaryFailure=3]="TemporaryFailure",e[e.InternalFailure=4]="InternalFailure",e[e.UnsupportedFormat=5]="UnsupportedFormat",e[e.Timeout=6]="Timeout",e[e.TooBig=7]="TooBig",e[e.InvalidMetadata=8]="InvalidMetadata",e[e.SourceCorrupt=9]="SourceCorrupt",e[e.TimeBudgetExceeded=10]="TimeBudgetExceeded",e[e.NotFound=11]="NotFound",e[e.PasswordProtected=12]="PasswordProtected",e[e.InvalidRequest=13]="InvalidRequest",e[e.VirusDetected=14]="VirusDetected",e[e.BlockMissing=15]="BlockMissing"})(t.RivieraStatus||(t.RivieraStatus={}))}),define("file-viewer/core/extension_constants",["require","exports"],function(e,t){"use strict";function r(e){return e=e.toLowerCase(),t.DOC_EXTS.includes(e)?"ssr_doc":t.PHOTO_EXTS.includes(e)?"image":m.includes(e)?"video":g.includes(e)?"audio":b.includes(e)?"linkfile":_.includes(e)?"html":"other"}Object.defineProperty(t,"__esModule",{value:!0});var i=[".odt",".wpd"],n=[".odp"],a=[".doc",".docx",".docm",".rtf"],o=[".ppt",".pps",".ppsx",".ppsm",".pptx",".pptm"],s=[".pdf"],l=[".ai",".eps"];t.PHOTO_EXTS=[".bmp",".gif",".jpeg",".jpg",".png",".tif",".tiff",".wbmp",".webp"];var c=[".key",".keynote"],u=[".dwg"],d=[".as",".as3",".asm",".aspx",".bat",".c",".cc",".cmake",".coffee",".cpp",".cs",".css",".cxx",".diff",".erb",".erl",".groovy",".gry",".h",".haml",".hh",".hpp",".hxx",".java",".js",".json",".jsx",".less",".lst",".m",".make",".ml",".mm",".out",".patch",".php",".pl",".plist",".properties",".py",".rb",".sass",".scala",".scm",".script",".scss",".sh",".sml",".sql",".tsx",".vb",".vi",".vim",".xml",".xsd",".xsl",".yaml",".yml"],p=[".epub"],f=[".markdown",".mdown",".mkdn",".md"],v=[".abap",".ada",".adp",".ahk",".asc",".ascx",".asp",".awk",".bash",".bash_login",".bash_logout",".bash_profile",".bashrc",".bib",".bsh",".build",".builder",".c++",".capfile",".cfc",".cfm",".cfml",".cl",".clj",".cls",".cmd",".cpt",".cpy",".cshtml",".cson",".csproj",".ctp",".d",".ddl",".di",".dif",".disco",".dml",".dtd",".dtml",".el",".emakefile",".f",".f90",".f95",".fs",".fsi",".fsscript",".fsx",".gemfile",".gemspec",".gitconfig",".go",".gvy",".h++",".handlebars",".hbs",".hcp",".hrl",".hs",".htc",".idl",".iim",".inc",".inf",".ini",".inl",".ipp",".irbrc",".jade",".jav",".jsp",".l",".lhs",".lisp",".log",".ltx",".lua",".markdn",".mli",".mll",".mly",".mud",".nfo",".opml",".osascript",".out",".p",".pas",".patch",".php2",".php3",".php4",".php5",".phtml",".pm",".pod",".pp",".profile",".ps1",".psd1",".psm1",".pt",".pyw",".r",".rake",".rbx",".rc",".re",".readme",".reg",".rest",".resw",".resx",".rhtml",".rjs",".rprofile",".rpy",".rss",".rst",".rxml",".s",".scm",".sconscript",".sconstruct",".sgml",".shtml",".sty",".swift",".tcl",".tex",".text",".textile",".tld",".tli",".tmpl",".tpl",".txt",".vim",".wsdl",".xhtml",".xoml",".xslt",".yaws",".zsh"],_=d.concat(p,f,v),m=[".3gp",".3gpp",".3gpp2",".asf",".avi",".dv",".flv",".m2t",".m4v",".mkv",".mov",".mp4",".mpeg",".mpg",".mts",".mxf",".oggtheora",".ogv",".rm",".ts",".vob",".webm",".wmv"],g=[".aac",".aif",".aiff",".m4a",".m4r",".mp3",".oga",".wav",".wma"],w=[".url",".website"],h=[".webloc"],b=w.concat(h);t.PRESENTATION_EXTS=o.concat(n),t.DOC_EXTS=s.concat(l,n,i,o,a,c,u),t.resolvePreviewType=r}),define("file-viewer/core/i18n",["require","exports","tslib","intl-messageformat","file-viewer/core/uuid"],function(e,t,r,i,n){"use strict";function a(e,t){var r=Array.isArray(e)?e.slice():[e];if(r.sort(),!t)return r.join("|");var i=Object.keys(t);return i.sort(),i.reduce(function(e,r){return e+"|"+r+"="+t[r]},r.join("|"))}function o(e,t){return function(r,i){var n=a(e,i);return t[n]||(t[n]=new Intl.NumberFormat(e,i)),t[n].format(r)}}function s(e,t){return function(r,i){var n=a(e,i);return t[n]||(t[n]=new Intl.DateTimeFormat(e,i)),t[n].format(r)}}function l(e){return e.replace(/%\((.*?)\)s/g,"{$1}")}function c(e,t){var r={},i={};t&&(r=Object.keys(t).reduce(function(e,r){var a=t[r];if("object"==typeof a){var o=n.v4();i[o]=a,e[r]=_+o+_}else e[r]=a;return e},{}));var a=e(r),o=Object.keys(i);return t&&o.length?a.split(_).filter(Boolean).map(function(e){return e in i?i[e]:e}):a}function u(e,t,r){return void 0===r&&(r={}),function(n,a){var o,s=n.id,l=n.defaultMessage;return s?(o=r[s],o||(o=new i.default(t[s]||l,e)),r[s]=o):o=new i.default(l,e),c(function(e){return o.format(e)},a)}}function d(e,t,r){void 0===r&&(r={});var i=Object.keys(t).reduce(function(e,r){var i=t[r];return"object"==typeof i?(e[r+"-one"]=l(i.message(1)),e[r+"-other"]=l(i.message(2))):e[r]=l(i),e},{}),n=u(e,i,r);return function(e,r){var i=e.id,a=e.defaultMessage;if(i){var o=t[i];if("object"==typeof o&&r){return n({id:r[o.token]>1?i+"-other":i+"-one",defaultMessage:a},r)}}return r?n(e,r):n(e)}}function p(){return{messageFormat:{},numberFormat:{},dateTimeFormat:{}}}function f(e,t,r){return{formatMessage:u(e,t,r.messageFormat),formatNumber:o(e,r.numberFormat),formatDateTime:s(e,r.dateTimeFormat)}}function v(e,t,r){return{formatMessage:d(e,t,r.messageFormat),formatNumber:o(e,r.numberFormat),formatDateTime:s(e,r.dateTimeFormat)}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i);var _="@__"+n.v4()+"__@";t.createI18nCache=p,t.createFormatters=f,t.createMetaserverFormatters=v,t.dummyFormatMessage=function(e){return e.defaultMessage},t.dummyI18nFormatters=f("en",{},p()),t.dummyMetaserverI18nFormatters=v("en",{},p())}),define("file-viewer/core",["require","exports","file-viewer/core/utils","file-viewer/core/i18n","file-viewer/core/invariant","file-viewer/core/ui/types","file-viewer/core/uuid","file-viewer/core/bootstrap","file-viewer/core/data/reducer","file-viewer/core/data/models","file-viewer/core/data/actions","modules/clean/api_v2/redux/previews","file-viewer/core/logging/session","file-viewer/core/logging/actions","file-viewer/core/urls","file-viewer/core/data/riviera","file-viewer/core/extension_constants","file-viewer/core/utils","file-viewer/core/config","file-viewer/core/data/modes/types"],function(e,t,r,i,n,a,o,s,l,c,u,d,p,f,v,_,m,g,w,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateFitBox=r.calculateFitBox,t.shallowEqual=r.shallowEqual,t.createFormatters=i.createFormatters,t.createI18nCache=i.createI18nCache,t.dummyFormatMessage=i.dummyFormatMessage,t.dummyI18nFormatters=i.dummyI18nFormatters,t.createMetaserverFormatters=i.createMetaserverFormatters,t.dummyMetaserverI18nFormatters=i.dummyMetaserverI18nFormatters,t.invariant=n.invariant,t.Theme=a.Theme,t.uuidV4=o.v4,t.createFileViewerSDK=s.createFileViewerSDK,t.reducers=l.reducers,t.DEFAULT_FILE_PREVIEW_UI=l.DEFAULT_FILE_PREVIEW_UI,t.DEFAULT_USER=l.DEFAULT_USER,t.PreviewType=c.PreviewType,t.Action=u.Action,t.fetchDataForPageResultAction=u.fetchDataForPageResultAction,t.fetchDocMetadataAction=u.fetchDocMetadataAction,t.fetchDocMetadataResultAction=u.fetchDocMetadataResultAction,t.refreshBlobSuccessAction=u.refreshBlobSuccessAction,t.updateDocCurrentPageIndex=u.updateDocCurrentPageIndex,t.zoomIn=u.zoomIn,t.zoomOut=u.zoomOut,t.zoomOriginalOrFit=u.zoomOriginalOrFit,t.updateMinScaleFactor=u.updateMinScaleFactor,t.refreshBlobAction=u.refreshBlobAction,t.openDocSidebar=u.openDocSidebar,t.closeDocSidebar=u.closeDocSidebar,t.setCurrentFilePreview=u.setCurrentFilePreview,t.pageUp=u.pageUp,t.pageDown=u.pageDown,t.changeMode=u.changeMode,t.sidebarControlClickAction=u.sidebarControlClickAction,t.setSidebarVisibilityAction=u.setSidebarVisibilityAction,t.previewsDataMiddleware=d.middleware,t.createFilePreviewSession=p.createFilePreviewSession,t.EventType=p.EventType,t.DeviceType=p.DeviceType,t.SourceAction=p.SourceAction,t.SourceContext=p.SourceContext,t.UserAction=p.UserAction,t.UserActionContext=p.UserActionContext,t.logEvent=f.logEvent,t.logTTI=f.logTTI,t.imageUrl=v.imageUrl,t.RivieraStatus=_.RivieraStatus,t.RivieraError=_.RivieraError,t.PHOTO_EXTS=m.PHOTO_EXTS,t.DOC_EXTS=m.DOC_EXTS,t.PRESENTATION_EXTS=m.PRESENTATION_EXTS,t.resolvePreviewType=m.resolvePreviewType,t.getFileExtension=g.getFileExtension,t.fileSizeSupported=g.fileSizeSupported,t.getFileSizeLimit=g.getFileSizeLimit,t.resolveAsset=g.resolveAsset,t.DEFAULT_CONFIG=w.DEFAULT_CONFIG,t.SidebarControlId=h.SidebarControlId,t.SidebarPaneId=h.SidebarPaneId,t.SidebarVisibility=h.SidebarVisibility,t.FileViewerMode=h.FileViewerMode}),define("file-viewer/core/invariant",["require","exports"],function(e,t){"use strict";function r(e,t){if(!e){var r=void 0;throw void 0===t?r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings."):(r=new Error(t),r.name="Invariant Violation"),r.framesToPop=1,r}}Object.defineProperty(t,"__esModule",{value:!0}),t.invariant=r}),define("file-viewer/core/logging/actions",["require","exports"],function(e,t){
"use strict";function r(e){return{type:"@@previews/log",payload:e}}function i(e){return{type:"@@previews/logTTI",payload:e}}function n(e){return{type:"@@previews/updateSession",payload:e}}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.UpdateSession="@@previews/updateSession",e.Log="@@previews/log",e.LogTTI="@@previews/logTTI"})(t.Action||(t.Action={})),t.logEvent=r,t.logTTI=i,t.updateSession=n}),define("file-viewer/core/logging/session",["require","exports","tslib","file-viewer/core/uuid","file-viewer/core/invariant"],function(e,t,r,i,n){"use strict";function a(e){var t,n=e||{},a=n.file_viewer_session_id,o=void 0===a?i.v4():a,s=n.file_preview_session_id,l=void 0===s?i.v4():s,c=n.file_id,u=void 0===c?"":c,d=n.file_extension,p=void 0===d?"":d,f=n.device_type,v=void 0===f?"desktop":f,_=n.extra,m=void 0===_?{}:_;return{file_viewer_session_id:o,file_preview_session_id:l,file_id:u,file_extension:p,device_type:v,extra:r.__assign({},m,{source_action:m.source_action||"visit",source_context:m.source_context||"file_viewer",file_preview_timeline:(t={},t.preview_attempted=Date.now(),t)})}}function o(e,t){var i,a=e.extra.file_preview_timeline;if(a[t])return e;switch(t){case"support_confirmed":case"support_denied":n.invariant(!!a.preview_attempted,"Event out of order"),n.invariant(!a.support_confirmed,"Cannot record support_confirmed & support_denied at the same time"),n.invariant(!a.support_denied,"Cannot record support_confirmed & support_denied at the same time");break;case"download_attempted":n.invariant(!!a.support_confirmed,"Event out of order");break;case"download_failed":case"download_succeeded":n.invariant(!!a.download_attempted,"Event out of order"),n.invariant(!a.download_succeeded,"Cannot record download_succeeded & download_failed at the same time"),n.invariant(!a.download_failed,"Cannot record download_succeeded & download_failed at the same time");break;case"render_succeeded":case"render_failed":n.invariant(!!a.download_succeeded,"Event out of order"),n.invariant(!a.render_succeeded,"Cannot record render_succeeded & render_failed at the same time"),n.invariant(!a.render_failed,"Cannot record render_succeeded & render_failed at the same time")}return r.__assign({},e,{extra:r.__assign({},e.extra,{file_preview_timeline:r.__assign({},e.extra.file_preview_timeline,(i={},i[t]=Date.now(),i))})})}function s(e){var t=r.__assign({},e.extra);if(t.time_to_primary_mark)return e;switch(t.primary_mark_ts||(t.primary_mark_ts=Date.now()),t.source_action){case"visit":n.invariant(!!t.page_start_ts,"Cannot calculate 1st page TTI without page_start_ts"),t.time_to_primary_mark=t.primary_mark_ts-t.page_start_ts;break;case"click":n.invariant(t.file_preview_timeline&&!!t.file_preview_timeline.preview_attempted,"Cannot calculate subsequent page TTI without preview_attempted timestamp"),t.time_to_primary_mark=t.primary_mark_ts-t.file_preview_timeline.preview_attempted}return r.__assign({},e,{extra:t})}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.mobile="mobile",e.tablet="tablet",e.desktop="desktop"})(t.DeviceType||(t.DeviceType={})),(function(e){e.Visit="visit",e.Click="click"})(t.SourceAction||(t.SourceAction={})),(function(e){e.FilePreviewSessionEnded="preview_session_ended",e.FilePreviewAttemptStarted="preview_attempted",e.FilePreviewSupportConfirmed="support_confirmed",e.FilePreviewSupportDenied="support_denied",e.FilePreviewDownloadAttempted="download_attempted",e.FilePreviewDownloadSucceeded="download_succeeded",e.FilePreviewDownloadFailed="download_failed",e.FilePreviewRenderSucceeded="render_succeeded",e.FilePreviewRenderFailed="render_failed",e.UserAction="user_action"})(t.EventType||(t.EventType={})),(function(e){e.Browse="browse",e.SharedLinkFile="sl_file",e.SharedLinkFolder="sl_folder",e.SharedLinkCollection="sl_collection",e.VersionHistory="version_history",e.FileViewer="file_viewer",e.Desktop="desktop",e.EmbeddedSharedLinkFile="embedded_sl_file",e.ArchiveFile="archive_file"})(t.SourceContext||(t.SourceContext={})),(function(e){e.Share="share",e.Download="download",e.PageChange="page_change",e.PageUp="page_up",e.PageDown="page_down",e.ToggleFullscreenOn="toggle_fullscreen_on",e.ToggleFullscreenOff="toggle_fullscreen_off",e.CloseDocSidebar="close_doc_sidebar",e.OpenDocSidebar="open_doc_sidebar",e.FlipNext="flip_next",e.FlipPrevious="flip_prev",e.ZoomIn="zoom_in",e.ZoomOut="zoom_out",e.ZoomOriginalOrFit="zoom_original_or_fit",e.ToggleSidebarOn="toggle_sidebar_on",e.ToggleSidebarOff="toggle_sidebar_off",e.PageJump="page_jump",e.ModeChange="mode_change"})(t.UserAction||(t.UserAction={})),(function(e){e.Toolbar="toolbar",e.DocSidebar="doc_sidebar",e.Sidebar="sidebar",e.MouseWheel="mouse_wheel",e.DocReset="doc_reset",e.DocLink="doc_link"})(t.UserActionContext||(t.UserActionContext={})),t.createFilePreviewSession=a,t.recordEvent=o,t.markTTI=s}),define("file-viewer/core/middlewares/analytics",["require","exports","tslib","file-viewer/core/logging/actions","file-viewer/core/logging/session"],function(e,t,r,i,n){"use strict";function a(e){return Object.keys(e).reduce(function(t,r){var i=e[r];return"string"==typeof i||"number"==typeof i?t[r]=i:"boolean"==typeof i?t[r]=+i:"object"==typeof i&&i&&(t[r]=JSON.stringify(a(i))),t},{})}function o(e){return r.__assign({},e,{extra:a(e.extra)})}function s(e){return function(t){var s=t.getState;return function(t){return function(l){var u=null;if("@@previews/log"===l.type){var d=l.payload,p=d.event,f=d.fileViewerId;return u=n.recordEvent(s().loggingSession[f],p),e.log(p,o(u)),t(i.updateSession(u))}if("@@previews/logTTI"===l.type)return u=n.markTTI(s().loggingSession[l.payload]),e.logTTI(),t(i.updateSession(u));if(l.type in c){var v=l.payload,f=v.fileViewerId,_=v.sourceContext,m=s().loggingSession[f];e.log("user_action",o(r.__assign({},m,{extra:a({context:_,action:c[l.type]})})))}return t(l)}}}}Object.defineProperty(t,"__esModule",{value:!0});var l,c=(l={},l["@@previews/zoomIn"]="zoom_in",l["@@previews/zoomOut"]="zoom_out",l["@@previews/fileViewerUi/closeDocSidebar"]="close_doc_sidebar",l["@@previews/fileViewerUi/openDocSidebar"]="open_doc_sidebar",l["@@previews/zoomOriginalOrFit"]="zoom_original_or_fit",l["@@previews/modes/changeMode"]="mode_change",l["@@previews/updateDocCurrentPageIndex"]="page_jump",l["@@previews/pageDown"]="page_down",l["@@previews/pageUp"]="page_up",l);t.analyticsMiddleware=s}),define("file-viewer/core/middlewares/riviera_data",["require","exports","tslib","file-viewer/core/data/actions","file-viewer/core/data/riviera","file-viewer/core/data/riviera/transform","file-viewer/core/invariant","file-viewer/core/urls"],function(e,t,r,i,n,a,o,s){"use strict";function l(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var s,l,c,u,d;return r.__generator(this,function(r){switch(r.label){case 0:s=n.payload.fileIdOrRevisionId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.fetchDocMetadata(n.payload.textUrlTmpl,!0)];case 2:return l=r.sent(),s=n.payload.fileIdOrRevisionId,o.invariant(!!e.previewData[s],"Preview Data for "+s+" should have been available"),c=e.previewData[s].content.image_url_tmpl,u=e.rivieraData[s]&&e.rivieraData[s].metadata,[2,i.fetchDocMetadataResultAction(s,a.processTextResponse(c,l,u))];case 3:return d=r.sent(),[2,i.fetchDocMetadataResultAction(n.payload.fileIdOrRevisionId,void 0,d)];case 4:return[2]}})})}function c(e){var t=this,c=new n.RivieraClientBase(e);return function(e){var n=e.getState,u=e.dispatch;return function(e){return function(d){return r.__awaiter(t,void 0,void 0,function(){var t,p,f,v,_,m,g,w,h,b,y,A,P;return r.__generator(this,function(F){switch(F.label){case 0:switch(p=n(),f=d.type){case"@@previews/fetchDocMetadata":return[3,1];case"@@previews/refreshBlob":return[3,3];case"@@previews/fetchDataForPage":return[3,7]}return[3,10];case 1:return v=e,[4,l(p,c,d)];case 2:return[2,v.apply(void 0,[F.sent()])];case 3:t=d.payload.fileIdOrRevisionId,F.label=4;case 4:return F.trys.push([4,6,,7]),[4,c.refreshDocBlob(d.payload.refreshUrl,d.payload.password)];case 5:return _=F.sent(),m=e(i.refreshBlobSuccessAction({fileIdOrRevisionId:t,preview:_})),o.invariant(!!p.previewData[t],"Preview Data for "+t+" should have been available"),g=p.rivieraData[t],g&&Array.isArray(g.pages)&&(w=r.__assign({},g,{pages:g.pages.map(function(e){return r.__assign({},e,{thumbnailUrl:s.imageUrl(_.image_url_tmpl,{page:e.pageIndex,scale_percent:0}),imgUrls:{"1x":s.imageUrl(_.image_url_tmpl,{page:e.pageIndex,scale_percent:0}),"4x":s.imageUrl(_.image_url_tmpl,{page:e.pageIndex,scale_percent:400})}})})}),e(i.fetchDocMetadataResultAction(t,w))),d.payload.password?[2,u(i.fetchDocMetadataAction(t,_.text_url_tmpl))]:[2,m];case 6:return h=F.sent(),[2,e(i.fetchDocMetadataResultAction(d.payload.fileIdOrRevisionId,void 0,h))];case 7:return F.trys.push([7,9,,10]),[4,c.fetchDocMetadata(d.payload.textUrlTmpl,!1,d.payload.pageLowerBound,d.payload.pageUpperBound)];case 8:return b=F.sent(),t=d.payload.fileIdOrRevisionId,o.invariant(!!p.previewData[t],"Preview Data for "+t+" should have been available"),y=p.previewData[t].content.image_url_tmpl,A=p.rivieraData[t]&&p.rivieraData[t].metadata,[2,e(i.fetchDataForPageResultAction(d.payload.fileIdOrRevisionId,a.processTextResponse(y,b,A)))];case 9:return P=F.sent(),[3,10];case 10:return[2,e(d)]}})})}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.rivieraDataMiddleware=c}),define("file-viewer/core/middlewares/ui_action_redispatcher",["require","exports","tslib","file-viewer/core/data/actions"],function(e,t,r,i){"use strict";function n(e){return!!e.metadata}Object.defineProperty(t,"__esModule",{value:!0}),t.uiActionRedispatcher=function(e){var t=e.getState;return function(e){return function(a){var o=t(),s=o.fileViewerUi,l=o.previewData,c=o.rivieraData,u=a.payload,d=u.fileIdOrRevisionId,p=u.fileViewerId,f=l[d],v=c[d];if(!(s[p]&&f&&f.content&&v))return e(a);if(!s[p][d])return e(a);switch(a.type){case"@@previews/zoomIn":return e(i.zoomIn(r.__assign({},a.payload,{previewType:"ssr_doc"===f.content[".tag"]?"ssr_doc":"image"})));case"@@previews/zoomOut":return e(i.zoomOut(r.__assign({},a.payload,{previewType:"ssr_doc"===f.content[".tag"]?"ssr_doc":"image"})));case"@@previews/pageDown":if("ssr_doc"===f.content[".tag"]&&n(v)&&v.metadata)return e(i.pageDown(r.__assign({},a.payload,{pageCount:v.metadata.page_count})))}return e(a)}}}}),define("file-viewer/core/ui/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.win="win",e.osx="osx",e.web="web"})(t.Theme||(t.Theme={}))}),define("file-viewer/core/urls",["require","exports"],function(e,t){"use strict";function r(e,t){Object.keys(t).forEach(function(r){e.searchParams.set(r,t[r])})}function i(e,t){var r=new URL(e);return r.searchParams.set("page",t[n.page].toString()),r.searchParams.set("scale_percent",t[n.scale_percent].toString()),r.toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.updateQueryParam=r;var n;(function(e){e.scale_percent="scale_percent",e.page="page"})(n||(n={})),t.imageUrl=i}),define("file-viewer/core/utils",["require","exports","file-viewer/core/extension_constants"],function(e,t,r){"use strict";function i(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t}function n(e,t){if(i(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!i(e[r[a]],t[r[a]]))return!1;return!0}function a(e,t,r){var i=e/t;return isNaN(r)||isNaN(i)||!isFinite(i)||!isFinite(r)?[0,0]:i>r?[t*r,t]:[e,e/r]}function o(e){var t=e.toLowerCase().match(/\.\w+$/);return t?t[0]:""}function s(e,t){var i=o(e),n=r.resolvePreviewType(i);return".pdf"===i?t.pdf_size_limit:r.PRESENTATION_EXTS.includes(i)?t.ppt_size_limit:r.DOC_EXTS.includes(i)?t.word_doc_size_limit:"archive"===n?t.archive_size_limit:"html"===n||"text"===n?t.text_size_limit:"linkfile"===n?t.linkfile_size_limit:0}function l(e,t,r){if(!isFinite(t))return!0;var i=s(e,r);return!i||t<=i}function c(e,t){return e[t]||t}Object.defineProperty(t,"__esModule",{value:!0}),t.shallowEqual=n,t.calculateFitBox=a;t.getFileExtension=o,t.getFileSizeLimit=s,t.fileSizeSupported=l,t.resolveAsset=c}),define("file-viewer/core/uuid",["require","exports"],function(e,t){"use strict";function r(e){return e.map(function(e){return a[e]}).join("")}function i(){var e=new Uint8Array(16);return"undefined"!=typeof window&&(window.crypto||window.msCrypto)&&(window.crypto||window.msCrypto).getRandomValues(e),e}function n(){var e=i();e[6]=15&e[6]|64,e[8]=63&e[8]|128;var t=Array.prototype.slice.call(e);return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map(r).join("-")}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){var e,t,r=[];for(e=0,t=e;e<=255;e++,t=e)r.push((t+256).toString(16).substr(1));return r})();t.v4=n}),define("intl-messageformat",[],function(){return function(){"use strict";function e(e){var t,r,i,n,a=Array.prototype.slice.call(arguments,1);for(t=0,r=a.length;t<r;t+=1)if(i=a[t])for(n in i)s.call(i,n)&&(e[n]=i[n]);return e}function t(e,t,r){this.locales=e,this.formats=t,this.pluralFn=r}function r(e){this.id=e}function i(e,t,r,i,n){this.id=e,this.useOrdinal=t,this.offset=r,this.options=i,this.pluralFn=n}function n(e,t,r,i){this.id=e,this.offset=t,this.numberFormat=r,this.string=i}function a(e,t){this.id=e,this.options=t}function o(e,t,r){var i="string"==typeof e?o.__parse(e):e;if(!i||"messageFormatPattern"!==i.type)throw new TypeError("A message must be provided as a String or AST.");r=this._mergeFormats(o.formats,r),c(this,"_locale",{value:this._resolveLocale(t)});var n=this._findPluralRuleFunction(this._locale),a=this._compilePattern(i,t,r,n),s=this;this.format=function(t){try{return s._format(a,t)}catch(t){throw t.variableId?new Error("The intl string context variable '"+t.variableId+"' was not provided to the string '"+e+"'"):t}}}var s=Object.prototype.hasOwnProperty,l=(function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}})(),c=(!l&&Object.prototype.__defineGetter__,l?Object.defineProperty:function(e,t,r){"get"in r&&e.__defineGetter__?e.__defineGetter__(t,r.get):(!s.call(e,t)||"value"in r)&&(e[t]=r.value)}),u=Object.create||function(e,t){function r(){}var i,n;r.prototype=e,i=new r;for(n in t)s.call(t,n)&&c(i,n,t[n]);return i},d=t;t.prototype.compile=function(e){return this.pluralStack=[],this.currentPlural=null,this.pluralNumberFormat=null,this.compileMessage(e)},t.prototype.compileMessage=function(e){if(!e||"messageFormatPattern"!==e.type)throw new Error('Message AST is not of type: "messageFormatPattern"');var t,r,i,n=e.elements,a=[];for(t=0,r=n.length;t<r;t+=1)switch(i=n[t],i.type){case"messageTextElement":a.push(this.compileMessageText(i));break;case"argumentElement":a.push(this.compileArgument(i));break;default:throw new Error("Message element does not have a valid type")}return a},t.prototype.compileMessageText=function(e){return this.currentPlural&&/(^|[^\\])#/g.test(e.value)?(this.pluralNumberFormat||(this.pluralNumberFormat=new Intl.NumberFormat(this.locales)),new n(this.currentPlural.id,this.currentPlural.format.offset,this.pluralNumberFormat,e.value)):e.value.replace(/\\#/g,"#")},t.prototype.compileArgument=function(e){var t=e.format;if(!t)return new r(e.id);var n,o=this.formats,s=this.locales,l=this.pluralFn;switch(t.type){case"numberFormat":return n=o.number[t.style],{id:e.id,format:new Intl.NumberFormat(s,n).format};case"dateFormat":return n=o.date[t.style],{id:e.id,format:new Intl.DateTimeFormat(s,n).format};case"timeFormat":return n=o.time[t.style],{id:e.id,format:new Intl.DateTimeFormat(s,n).format};case"pluralFormat":return n=this.compileOptions(e),new i(e.id,t.ordinal,t.offset,n,l);case"selectFormat":return n=this.compileOptions(e),new a(e.id,n);default:throw new Error("Message element does not have a valid format type")}},t.prototype.compileOptions=function(e){var t=e.format,r=t.options,i={};this.pluralStack.push(this.currentPlural),this.currentPlural="pluralFormat"===t.type?e:null;var n,a,o;for(n=0,a=r.length;n<a;n+=1)o=r[n],i[o.selector]=this.compileMessage(o.value);return this.currentPlural=this.pluralStack.pop(),i},r.prototype.format=function(e){return e||"number"==typeof e?"string"==typeof e?e:String(e):""},i.prototype.getOption=function(e){var t=this.options;return t["="+e]||t[this.pluralFn(e-this.offset,this.useOrdinal)]||t.other},n.prototype.format=function(e){var t=this.numberFormat.format(e-this.offset);return this.string.replace(/(^|[^\\])#/g,"$1"+t).replace(/\\#/g,"#")},a.prototype.getOption=function(e){var t=this.options;return t[e]||t.other};var p=(function(){function e(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}function t(e,r,i,n){this.message=e,this.expected=r,this.found=i,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}function r(e){function r(){return n(Ce,Me)}function i(t){var r,i,n=Ee[t];if(n)return n;for(r=t-1;!Ee[r];)r--;for(n=Ee[r],n={line:n.line,column:n.column,seenCR:n.seenCR};r<t;)i=e.charAt(r),"\n"===i?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Ee[t]=n,n}function n(e,t){var r=i(e),n=i(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function a(e){Me<Oe||(Me>Oe&&(Oe=Me,Te=[]),Te.push(e))}function o(e,r,i,n){function a(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function r(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var i,n,a,o=new Array(e.length);for(a=0;a<e.length;a++)o[a]=e[a].description;return i=e.length>1?o.slice(0,-1).join(", ")+" or "+o[e.length-1]:o[0],n=t?'"'+r(t)+'"':"end of input","Expected "+i+" but "+n+" found."}return null!==r&&a(r),new t(null!==e?e:o(r,i),r,i,n)}function s(){return l()}function l(){var e,t,r;for(e=Me,t=[],r=c();r!==E;)t.push(r),r=c();return t!==E&&(Ce=e,t=U(t)),e=t}function c(){var e;return e=d(),e===E&&(e=f()),e}function u(){var t,r,i,n,a,o;if(t=Me,r=[],i=Me,n=F(),n!==E?(a=D(),a!==E?(o=F(),o!==E?(n=[n,a,o],i=n):(Me=i,i=E)):(Me=i,i=E)):(Me=i,i=E),i!==E)for(;i!==E;)r.push(i),i=Me,n=F(),n!==E?(a=D(),a!==E?(o=F(),o!==E?(n=[n,a,o],i=n):(Me=i,i=E)):(Me=i,i=E)):(Me=i,i=E);else r=E;return r!==E&&(Ce=t,r=k(r)),t=r,t===E&&(t=Me,r=P(),t=r!==E?e.substring(t,Me):r),t}function d(){var e,t;return e=Me,t=u(),t!==E&&(Ce=e,t=V(t)),e=t}function p(){var t,r,i;if(t=I(),t===E){if(t=Me,r=[],j.test(e.charAt(Me))?(i=e.charAt(Me),Me++):(i=E,0===Ue&&a(B)),i!==E)for(;i!==E;)r.push(i),j.test(e.charAt(Me))?(i=e.charAt(Me),Me++):(i=E,0===Ue&&a(B));else r=E;t=r!==E?e.substring(t,Me):r}return t}function f(){var t,r,i,n,o,s,l,c,u;return t=Me,123===e.charCodeAt(Me)?(r="{",Me++):(r=E,0===Ue&&a(L)),r!==E?(i=F(),i!==E?(n=p(),n!==E?(o=F(),o!==E?(s=Me,44===e.charCodeAt(Me)?(l=",",Me++):(l=E,0===Ue&&a(q)),l!==E?(c=F(),c!==E?(u=v(),u!==E?(l=[l,c,u],s=l):(Me=s,s=E)):(Me=s,s=E)):(Me=s,s=E),s===E&&(s=null),s!==E?(l=F(),l!==E?(125===e.charCodeAt(Me)?(c="}",Me++):(c=E,0===Ue&&a(G)),c!==E?(Ce=t,r=N(n,s),t=r):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E),t}function v(){var e;return e=_(),e===E&&(e=m(),e===E&&(e=g(),e===E&&(e=w()))),e}function _(){var t,r,i,n,o,s,l;return t=Me,"number"===e.substr(Me,6)?(r="number",Me+=6):(r=E,0===Ue&&a(z)),r===E&&("date"===e.substr(Me,4)?(r="date",Me+=4):(r=E,0===Ue&&a(W)),r===E&&("time"===e.substr(Me,4)?(r="time",Me+=4):(r=E,0===Ue&&a(X)))),r!==E?(i=F(),i!==E?(n=Me,44===e.charCodeAt(Me)?(o=",",Me++):(o=E,0===Ue&&a(q)),o!==E?(s=F(),s!==E?(l=D(),l!==E?(o=[o,s,l],n=o):(Me=n,n=E)):(Me=n,n=E)):(Me=n,n=E),n===E&&(n=null),n!==E?(Ce=t,r=H(r,n),t=r):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E),t}function m(){var t,r,i,n,o,s;return t=Me,"plural"===e.substr(Me,6)?(r="plural",Me+=6):(r=E,0===Ue&&a(Z)),r!==E?(i=F(),i!==E?(44===e.charCodeAt(Me)?(n=",",Me++):(n=E,0===Ue&&a(q)),n!==E?(o=F(),o!==E?(s=A(),s!==E?(Ce=t,r=K(s),t=r):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E),t}function g(){var t,r,i,n,o,s;return t=Me,"selectordinal"===e.substr(Me,13)?(r="selectordinal",Me+=13):(r=E,0===Ue&&a(Q)),r!==E?(i=F(),i!==E?(44===e.charCodeAt(Me)?(n=",",Me++):(n=E,0===Ue&&a(q)),n!==E?(o=F(),o!==E?(s=A(),s!==E?(Ce=t,r=Y(s),t=r):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E),t}function w(){var t,r,i,n,o,s,l;if(t=Me,"select"===e.substr(Me,6)?(r="select",Me+=6):(r=E,0===Ue&&a(J)),r!==E)if(i=F(),i!==E)if(44===e.charCodeAt(Me)?(n=",",Me++):(n=E,0===Ue&&a(q)),n!==E)if(o=F(),o!==E){if(s=[],l=b(),l!==E)for(;l!==E;)s.push(l),l=b();else s=E;s!==E?(Ce=t,r=$(s),t=r):(Me=t,t=E)}else Me=t,t=E;else Me=t,t=E;else Me=t,t=E;else Me=t,t=E;return t}function h(){var t,r,i,n;return t=Me,r=Me,61===e.charCodeAt(Me)?(i="=",Me++):(i=E,0===Ue&&a(ee)),i!==E?(n=I(),n!==E?(i=[i,n],r=i):(Me=r,r=E)):(Me=r,r=E),t=r!==E?e.substring(t,Me):r,t===E&&(t=D()),t}function b(){var t,r,i,n,o,s,c,u,d;return t=Me,r=F(),r!==E?(i=h(),i!==E?(n=F(),n!==E?(123===e.charCodeAt(Me)?(o="{",Me++):(o=E,0===Ue&&a(L)),o!==E?(s=F(),s!==E?(c=l(),c!==E?(u=F(),u!==E?(125===e.charCodeAt(Me)?(d="}",Me++):(d=E,0===Ue&&a(G)),d!==E?(Ce=t,r=te(i,c),t=r):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E),t}function y(){var t,r,i,n;return t=Me,"offset:"===e.substr(Me,7)?(r="offset:",Me+=7):(r=E,0===Ue&&a(re)),r!==E?(i=F(),i!==E?(n=I(),n!==E?(Ce=t,r=ie(n),t=r):(Me=t,t=E)):(Me=t,t=E)):(Me=t,t=E),t}function A(){var e,t,r,i,n;if(e=Me,t=y(),t===E&&(t=null),t!==E)if(r=F(),r!==E){if(i=[],n=b(),n!==E)for(;n!==E;)i.push(n),n=b();else i=E;i!==E?(Ce=e,t=ne(t,i),e=t):(Me=e,e=E)}else Me=e,e=E;else Me=e,e=E;return e}function P(){var t,r;if(Ue++,t=[],oe.test(e.charAt(Me))?(r=e.charAt(Me),Me++):(r=E,0===Ue&&a(se)),r!==E)for(;r!==E;)t.push(r),oe.test(e.charAt(Me))?(r=e.charAt(Me),Me++):(r=E,0===Ue&&a(se));else t=E;return Ue--,t===E&&(r=E,0===Ue&&a(ae)),t}function F(){var t,r,i;for(Ue++,t=Me,r=[],i=P();i!==E;)r.push(i),i=P();return t=r!==E?e.substring(t,Me):r,Ue--,t===E&&(r=E,0===Ue&&a(le)),t}function S(){var t;return ce.test(e.charAt(Me))?(t=e.charAt(Me),Me++):(t=E,0===Ue&&a(ue)),t}function x(){var t;return de.test(e.charAt(Me))?(t=e.charAt(Me),Me++):(t=E,0===Ue&&a(pe)),t}function I(){var t,r,i,n,o,s;if(t=Me,48===e.charCodeAt(Me)?(r="0",Me++):(r=E,0===Ue&&a(fe)),r===E){if(r=Me,i=Me,ve.test(e.charAt(Me))?(n=e.charAt(Me),Me++):(n=E,0===Ue&&a(_e)),n!==E){for(o=[],s=S();s!==E;)o.push(s),s=S();o!==E?(n=[n,o],i=n):(Me=i,i=E)}else Me=i,i=E;r=i!==E?e.substring(r,Me):i}return r!==E&&(Ce=t,r=me(r)),t=r}function R(){var t,r,i,n,o,s,l,c;return ge.test(e.charAt(Me))?(t=e.charAt(Me),Me++):(t=E,0===Ue&&a(we)),t===E&&(t=Me,"\\\\"===e.substr(Me,2)?(r="\\\\",Me+=2):(r=E,0===Ue&&a(he)),r!==E&&(Ce=t,r=be()),t=r,t===E&&(t=Me,"\\#"===e.substr(Me,2)?(r="\\#",Me+=2):(r=E,0===Ue&&a(ye)),r!==E&&(Ce=t,r=Ae()),t=r,t===E&&(t=Me,"\\{"===e.substr(Me,2)?(r="\\{",Me+=2):(r=E,0===Ue&&a(Pe)),r!==E&&(Ce=t,r=Fe()),t=r,t===E&&(t=Me,"\\}"===e.substr(Me,2)?(r="\\}",Me+=2):(r=E,0===Ue&&a(Se)),r!==E&&(Ce=t,r=xe()),t=r,t===E&&(t=Me,"\\u"===e.substr(Me,2)?(r="\\u",Me+=2):(r=E,0===Ue&&a(Ie)),r!==E?(i=Me,n=Me,o=x(),o!==E?(s=x(),s!==E?(l=x(),l!==E?(c=x(),c!==E?(o=[o,s,l,c],n=o):(Me=n,n=E)):(Me=n,n=E)):(Me=n,n=E)):(Me=n,n=E),i=n!==E?e.substring(i,Me):n,i!==E?(Ce=t,r=Re(i),t=r):(Me=t,t=E)):(Me=t,t=E)))))),t}function D(){var e,t,r;if(e=Me,t=[],r=R(),r!==E)for(;r!==E;)t.push(r),r=R();else t=E;return t!==E&&(Ce=e,t=De(t)),e=t}var M,C=arguments.length>1?arguments[1]:{},E={},O={start:s},T=s,U=function(e){return{type:"messageFormatPattern",elements:e,location:r()}},k=function(e){var t,r,i,n,a,o="";for(t=0,i=e.length;t<i;t+=1)for(n=e[t],r=0,a=n.length;r<a;r+=1)o+=n[r];return o},V=function(e){return{type:"messageTextElement",value:e,location:r()}},j=/^[^ \t\n\r,.+={}#]/,B={type:"class",value:"[^ \\t\\n\\r,.+={}#]",description:"[^ \\t\\n\\r,.+={}#]"},L={type:"literal",value:"{",description:'"{"'},q={type:"literal",value:",",description:'","'},G={type:"literal",value:"}",description:'"}"'},N=function(e,t){return{type:"argumentElement",id:e,format:t&&t[2],location:r()}},z={type:"literal",value:"number",description:'"number"'},W={type:"literal",value:"date",description:'"date"'},X={type:"literal",value:"time",description:'"time"'},H=function(e,t){return{type:e+"Format",style:t&&t[2],location:r()}},Z={type:"literal",value:"plural",description:'"plural"'},K=function(e){return{type:e.type,ordinal:!1,offset:e.offset||0,options:e.options,location:r()}},Q={type:"literal",value:"selectordinal",description:'"selectordinal"'},Y=function(e){return{type:e.type,ordinal:!0,offset:e.offset||0,options:e.options,location:r()}},J={type:"literal",value:"select",description:'"select"'},$=function(e){return{type:"selectFormat",options:e,location:r()}},ee={type:"literal",value:"=",description:'"="'},te=function(e,t){return{type:"optionalFormatPattern",selector:e,value:t,location:r()}},re={type:"literal",value:"offset:",description:'"offset:"'},ie=function(e){return e},ne=function(e,t){return{type:"pluralFormat",offset:e,options:t,location:r()}},ae={type:"other",description:"whitespace"},oe=/^[ \t\n\r]/,se={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},le={type:"other",description:"optionalWhitespace"},ce=/^[0-9]/,ue={type:"class",value:"[0-9]",description:"[0-9]"},de=/^[0-9a-f]/i,pe={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},fe={type:"literal",value:"0",description:'"0"'},ve=/^[1-9]/,_e={type:"class",value:"[1-9]",description:"[1-9]"},me=function(e){return parseInt(e,10)},ge=/^[^{}\\\0-\x1F \t\n\r]/,we={type:"class",value:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]",description:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]"},he={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},be=function(){return"\\"},ye={type:"literal",value:"\\#",description:'"\\\\#"'},Ae=function(){return"\\#"},Pe={type:"literal",value:"\\{",description:'"\\\\{"'},Fe=function(){return"{"},Se={type:"literal",value:"\\}",description:'"\\\\}"'},xe=function(){return"}"},Ie={type:"literal",value:"\\u",description:'"\\\\u"'},Re=function(e){return String.fromCharCode(parseInt(e,16))},De=function(e){return e.join("")},Me=0,Ce=0,Ee=[{line:1,column:1,seenCR:!1}],Oe=0,Te=[],Ue=0;if("startRule"in C){if(!(C.startRule in O))throw new Error("Can't start parsing from rule \""+C.startRule+'".');T=O[C.startRule]}if(M=T(),M!==E&&Me===e.length)return M;throw M!==E&&Me<e.length&&a({type:"end",description:"end of input"}),o(null,Te,Oe<e.length?e.charAt(Oe):null,Oe<e.length?n(Oe,Oe+1):n(Oe,Oe))}return e(t,Error),{SyntaxError:t,parse:r}})(),f=o;c(o,"formats",{enumerable:!0,value:{number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}}}),c(o,"__localeData__",{value:u(null)}),c(o,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlMessageFormat is missing a `locale` property");o.__localeData__[e.locale.toLowerCase()]=e}}),c(o,"__parse",{value:p.parse}),c(o,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),o.prototype.resolvedOptions=function(){return{locale:this._locale}},o.prototype._compilePattern=function(e,t,r,i){return new d(t,r,i).compile(e)},o.prototype._findPluralRuleFunction=function(e){for(var t=o.__localeData__,r=t[e.toLowerCase()];r;){if(r.pluralRuleFunction)return r.pluralRuleFunction;r=r.parentLocale&&t[r.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlMessageFormat is missing a `pluralRuleFunction` for :"+e)},o.prototype._format=function(e,t){var r,i,n,a,o,l,c="";for(r=0,i=e.length;r<i;r+=1)if(n=e[r],"string"!=typeof n){if(a=n.id,!t||!s.call(t,a))throw l=new Error("A value must be provided for: "+a),l.variableId=a,l;o=t[a],c+=n.options?this._format(n.getOption(o),t):n.format(o)}else c+=n;return c},o.prototype._mergeFormats=function(t,r){var i,n,a={};for(i in t)s.call(t,i)&&(a[i]=n=u(t[i]),r&&s.call(r,i)&&e(n,r[i]));return a},o.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(o.defaultLocale);var t,r,i,n,a=o.__localeData__;for(t=0,r=e.length;t<r;t+=1)for(i=e[t].toLowerCase().split("-");i.length;){if(n=a[i.join("-")])return n.locale;i.pop()}var s=e.pop();throw new Error("No locale data has been added to IntlMessageFormat for: "+e.join(", ")+", or the default locale: "+s)};var v={locale:"en",pluralRuleFunction:function(e,t){var r=String(e).split("."),i=!r[1],n=Number(r[0])==e,a=n&&r[0].slice(-1),o=n&&r[0].slice(-2);return t?1==a&&11!=o?"one":2==a&&12!=o?"two":3==a&&13!=o?"few":"other":1==e&&i?"one":"other"}};f.__addLocaleData(v),f.defaultLocale="en";var _=f;this.IntlMessageFormat=_}.call(this),this.IntlMessageFormat}.bind(Object.create(null))),define("file-viewer/modes",["require","exports","file-viewer/modes/sidebar/sidebar","file-viewer/modes/sidebar/pane","file-viewer/modes/sidebar/control","file-viewer/modes/sidebar/utils"],function(e,t,r,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sidebar=r.Sidebar,t.Pane=i.Pane,t.CommentControl=n.CommentControl,t.DocumentationControl=n.DocumentationControl,t.WatermarkControl=n.WatermarkControl;t.SIDEBAR_OPEN_WIDTH=parseInt("376px",10),t.SIDEBAR_CLOSED_WIDTH=parseInt("56px",10),t.createSidebarDispatchHandler=a.createSidebarDispatchHandler,t.isSidebarOpen=a.isSidebarOpen}),define("file-viewer/modes/sidebar/control",["require","exports","tslib","classnames","react","spectrum/tooltip","file-viewer/core"],function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),n=r.__importStar(n);var s={totalWidthOpen:"376px",totalWidthClosed:"56px",control:"BXSQ8s4gfq",isSelected:"_3l-Swh4sdi",controlIcon:"_33nnkxMPOU"};t.Control=function(e){var t,r=e.labelText,l=e.id,c=e.dispatch,u=e.fileViewerUiData,d=e.fileViewerId;return n.createElement("button",{"aria-label":r,"data-control-id":l,className:i.default(s.control,(t={},t[s.isSelected]=u.sidebar.selectedControlId===l,t)),onClick:function(){return c(o.sidebarControlClickAction({fileViewerId:d,controlId:l}))}},n.createElement(a.Tooltip,{positionOffset:8,positioning:"left",tooltipContent:r},n.createElement("div",{className:s.controlIcon})))},t.DocumentationControl=function(e){var r=e.intl;return n.createElement(t.Control,Object.assign({},e,{id:o.SidebarControlId.Documentation,labelText:r.formatMessage({id:"17znK",defaultMessage:"About"})}))},t.CommentControl=function(e){var r=e.intl;return n.createElement(t.Control,Object.assign({},e,{id:o.SidebarControlId.Comments,labelText:r.formatMessage({id:"3rjoD",defaultMessage:"Comments"})}))},t.WatermarkControl=function(e){var r=e.intl;return n.createElement(t.Control,Object.assign({},e,{id:o.SidebarControlId.Watermark,labelText:r.formatMessage({id:"1l5w1",defaultMessage:"Watermark"})}))},t.defaultRenderSidebarControlsFn=function(e){return[n.createElement(t.DocumentationControl,Object.assign({key:"documentation-control"},e)),n.createElement(t.CommentControl,Object.assign({key:"comment-control"
},e)),n.createElement(t.WatermarkControl,Object.assign({key:"watermark-control"},e))]}}),define("file-viewer/modes/sidebar/control_list",["require","exports","tslib","react"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i);var n={totalWidthOpen:"376px",totalWidthClosed:"56px",controlList:"_5hRhvsTRDu"};t.ControlList=function(e){var t=e.renderSidebarControlsFn,a=r.__rest(e,["renderSidebarControlsFn"]);return i.createElement("div",{className:n.controlList},t(a))}}),define("file-viewer/modes/sidebar/pane",["require","exports","tslib","react"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i);var n={pane:"mr8CWsBI-a"};t.Pane=function(e){var t=e.children;return i.createElement("div",{className:n.pane},t)}}),define("file-viewer/modes/sidebar/pane_stack",["require","exports","tslib","react"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i);var n={totalWidthOpen:"376px",totalWidthClosed:"56px",paneStack:"_1I6XjY7iD9"};t.PaneStack=function(e){var t=e.registerSidebarPanesFn,a=r.__rest(e,["registerSidebarPanesFn"]),o=t(a),s=a.fileViewerUiData.sidebar.paneStack.map(function(e){var t=o[e];return t||console.error('Unable to find pane with paneId: "'+e+'"'),t}).filter(Boolean);return i.createElement("div",{className:n.paneStack},s)}}),define("file-viewer/modes/sidebar/sidebar",["require","exports","tslib","react","classnames","file-viewer/modes/sidebar/pane_stack","file-viewer/modes/sidebar/control_list","file-viewer/core"],function(e,t,r,i,n,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),n=r.__importDefault(n);var l={totalWidthOpen:"376px",totalWidthClosed:"56px",sidebar:"_1ah_BhOiDc",isOpen:"_35m4GZHt8p",widthClosed:"56px",widthOpen:"376px"};t.Sidebar=function(e){var t,r=e.renderSidebarControlsFn,c=e.registerSidebarPanesFn,u=e.fileViewerUiData.sidebar.visibility;return i.createElement("aside",{className:n.default(l.sidebar,(t={},t[l.isOpen]=u===s.SidebarVisibility.Open,t))},i.createElement(a.PaneStack,Object.assign({},e,{registerSidebarPanesFn:c})),i.createElement(o.ControlList,Object.assign({},e,{renderSidebarControlsFn:r})))}}),define("file-viewer/modes/sidebar/utils",["require","exports","file-viewer/core"],function(e,t,r){"use strict";function i(e){return"@@previews/sidebarControlClick"===e.type}function n(e){return"@@previews/setSidebarVisibility"===e.type}Object.defineProperty(t,"__esModule",{value:!0});var a,o=(a={},a[r.SidebarControlId.Documentation]=function(e,t){e(r.changeMode({fileViewerId:t,mode:r.FileViewerMode.Documentation,sourceContext:"sidebar"}))},a[r.SidebarControlId.Comments]=function(e,t){e(r.changeMode({fileViewerId:t,mode:r.FileViewerMode.Commenting,sourceContext:"sidebar"}))},a[r.SidebarControlId.Watermark]=function(e,t){e(r.changeMode({fileViewerId:t,mode:r.FileViewerMode.Watermarking,sourceContext:"sidebar"}))},a);t.createSidebarDispatchHandler=function(e,t){return function(r){if(i(r)){return(0,o[r.payload.controlId])(e,t,r)}return e(n(r)?r:r)}},t.isSidebarOpen=function(e){return e.visibility===r.SidebarVisibility.Open}}),define("file-viewer/strings",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strings={"6nnDP":{token:"number",message:function(e){return r.ungettext("Viewed %(number)s year ago","Viewed %(number)s years ago",e,{comment:"label for last time a user has viewed the file"})}},HTBEh:{token:"number",message:function(e){return r.ungettext("Viewed %(number)s month ago","Viewed %(number)s months ago",e,{comment:"label for last time a user has viewed the file"})}},"32pDF":{token:"number",message:function(e){return r.ungettext("Viewed %(number)s week ago","Viewed %(number)s weeks ago",e,{comment:"label for last time a user has viewed the file"})}},Roztq:{token:"number",message:function(e){return r.ungettext("Viewed %(number)s day ago","Viewed %(number)s days ago",e,{comment:"label for last time a user has viewed the file"})}},"1Vt6M":{token:"number",message:function(e){return r.ungettext("Viewed %(number)s hour ago","Viewed %(number)s hours ago",e,{comment:"label for last time a user has viewed the file"})}},"1-Qnz":{token:"number",message:function(e){return r.ungettext("Viewed %(number)s min ago","Viewed %(number)s mins ago",e,{comment:"label for last time a user has viewed the file"})}},"1A8Wt":r._("Viewed just now",{comment:"label for last time a user has viewed the file"}),"3f1s4":r._("Viewing now",{comment:"tooltip showing a user viewing a file"}),"3O68s":r._("99+",{comment:"label for facepile when there are more than 99 people having seen the file"}),"2u_Bg":{token:"count",message:function(e){return r.ungettext("%(count)s other","%(count)s others",e,{comment:"label for number of other people that viewed this file"})}},"380FK":r._("Hide sidebar",{comment:"Tooltip text to hide preview sidebar"}),"1-hY4":r._("Show sidebar",{comment:"Tooltip text to show preview sidebar"}),"3r1su":r._("Fullscreen",{comment:"Fullscreen control for preview toolbar"}),"1crUg":r._("Page down",{comment:"Page down control for preview toolbar"}),"30U9L":r._("Page up",{comment:"Page up control for preview toolbar"}),yOZ5I:r._("Zoom in",{comment:"Zoom in control for preview toolbar"}),"2dTGQ":r._("Zoom out",{comment:"Zoom out control for preview toolbar"}),"3A0DU":r._("Previous",{comment:"Flip to the previous file in a series of files when previewing files on the web"}),"1XG6i":r._("Next",{comment:"Flip to the next file in a series of files when previewing files on the web"}),"1LWb5":r._("%(file_number)s of %(file_count)s",{comment:"Index indicator for preview toolbar file flipping controls"}),"3Dloj":r._("Page...",{comment:"Placeholder text for preview toolbar page indicator input"}),Z4LHJ:r._("Click to jump to a page",{comment:"Tooltip text for the page indicator"}),"1BXqX":r._("Zoom to fit",{comment:"Toolbar tooltip text for zooming an image to fit the viewport"}),"2iKGa":r._("View actual size",{comment:"Toolbar tooltip text for zooming an image to its real size"}),"2yLzB":r._("Page %(index)s",{comment:"label for each document page"}),"2w1Rq":r._("Document Sidebar",{comment:"a11y label for doc sidebar"}),uh_2T:r._("External Link",{comment:"Label for external anchor link"}),PLDnD:r._("Internal Link",{comment:"Label for internal anchor link"}),ACvIY:r._("Reload",{comment:"Reload button label"}),"1_qu7":r._("Close",{comment:"Close button label"}),"2nXNn":r._("Document Password Modal",{comment:"password modal label"}),"35GUv":r._("This file is password protected",{comment:"modal title"}),MBnKP:r._("Submit",{comment:"submit button label"}),Cx9Xf:r._("Cancel",{comment:"Cancel button label"}),"2eyfy":r._("The password you entered is incorrect, please try again.",{comment:"message in modal when user enters wrong passwords"}),"3X32N":r._("Enter the password to open this file.",{comment:"Password input prompt"}),NlVBZ:r._("Password",{comment:"Password input placeholder"}),"3QbUM":r._("%(extension)s files can’t currently be previewed. Download the file to see its full contents.",{comment:"Preview Error section message"}),"3XBdD":r._("This file is password-protected",{comment:"Preview Error section title"}),"2hEJT":r._("Remove the password via the original application (eg. MS Word, Adobe Photoshop) to preview the file on dropbox.com, or download the file to see full contents.",{comment:"Preview Error section message"}),"1qFPZ":r._("This file cannot be previewed",{comment:"Preview Error section title"}),"3QN14":r._("This is a supported filetype by Dropbox, but something went wrong. The file may be corrupted or have an incorrect extension. To view its full contents, download the file",{comment:"Preview Error section message"}),"3IvZ8":r._("Files without extensions cannot be previewed",{comment:"Preview Error section title"}),"1OWrj":r._("File suffixes (or extensions) indicate the type of file, and helps Dropbox generate the preview. Please add an extension, or download the file on your computer to view it.",{comment:"Preview Error section message"}),"1sf_t":r._("This file is too big to preview",{comment:"Preview Error section title"}),"2Lxyo":r._("Couldn’t preview file because its size exceeds %(size)s maximum. To view, download the file or reduce its size.",{comment:"Preview Error section message"}),"2aX8q":r._("File is uploading",{comment:"Preview Error section title"}),"28Uhd":r._("Once the file is fully uploaded and synced, you can preview it on Dropbox. Please wait for the syncing process to complete before previewing the file.",{comment:"Preview Error section message"}),"17znK":r._("About",{comment:"Label next to a button that opens a sidebar pane with things like file metadata and activity."}),"3rjoD":r._("Comments",{comment:"Label next to a button that opens a sidebar pane for leaving comments on a file."}),"1l5w1":r._("Watermark",{comment:"Label next to a button that opens a sidebar pane for creating a watermark."}),"1D-MZ":r._("Can’t show link. Something’s wrong with this file.",{comment:"Shown instead of description if there is an error"}),iTxna:r._("Open in new tab",{comment:"Label text for open button"}),"2l6UF":{token:"number",message:function(e){return r.ungettext("%(number)s year ago","%(number)s years ago",e,{comment:"label for comment that was left a few years ago"})}},"4jyR0":{token:"number",message:function(e){return r.ungettext("%(number)s month ago","%(number)s months ago",e,{comment:"label for comment that was left a few months ago"})}},"1i3A1":{token:"number",message:function(e){return r.ungettext("%(number)s week ago","%(number)s weeks ago",e,{comment:"label for comment that was left a few weeks ago"})}},Vu6ED:{token:"number",message:function(e){return r.ungettext("%(number)s day ago","%(number)s days ago",e,{comment:"label for comment that was left a few days ago"})}},"2qR7n":{token:"number",message:function(e){return r.ungettext("%(number)s hour ago","%(number)s hours ago",e,{comment:"label for comment that was left a few hours ago"})}},"8pkVG":{token:"number",message:function(e){return r.ungettext("%(number)s min ago","%(number)s mins ago",e,{comment:"label for comment that was left a few mins ago"})}},"2qZ7G":r._("Just now",{comment:"label for comment that was left less than a min ago"}),"8fDlH":r._("@mention someone to share this file",{comment:"mention instruction message"}),"3iN4V":r._("@mention someone",{comment:"mention btn label"}),"1nqpH":r._("Searching contacts…",{comment:"message displayed while search is processed"}),"2lweF":r._("No Users Found",{comment:"No Users Found"}),"nlds-":r._("Invite %(user_name)s",{comment:"invite message"}),"3pIbH":r._("Save",{comment:"edit button label"}),"2Wo9h":r._("This comment was deleted.",{comment:"message after comment is deleted"}),"3x7uu":r._("Edit",{comment:"edit button label"}),"2oCAM":r._("Delete",{comment:"delete button label"}),"3ZEru":r._("Mark as read",{comment:"Mark as read button label"}),"3UAhM":r._("Mark as unread",{comment:"Mark as unread button label"}),"1oD4j":r._("Marked as resolved",{comment:"Marked as resolved button label"}),LeHxj:r._("On older version",{comment:"message displayed when user is viewing an older version of the file"}),"4vU51":r._("Write a comment",{comment:"Write a comment button label"}),"1-FNO":r._("Post",{comment:"Post button label"}),"31CgX":r._("Restore",{comment:"Restore button label"}),"2cH3Z":r._("Resolve",{comment:"Resolve button label"}),"1X0tz":r._("Reply",{comment:"Reply button label"}),"1jeeF":r._("View version history",{comment:"View version history button label"}),"3qNGZ":r._("Page %(page)s",{comment:"page number where comment was left on"}),"1CYeW":r._("%(count)s comments",{comment:"number of comments left"}),"1g0Xl":r._("%(count)s unread",{comment:"number of unread comments"}),"1j6jP":r._("Comment thread",{comment:"Comment thread accessbility label"}),"3zwVy":r._("Unread comment thread",{comment:"Unread comment thread accessbility label"})}}),define("modules/clean/api_v2/redux/base_action",["require","exports","tslib"],function(e,t,r){"use strict";function i(e){return function(t,r,i){return{type:e,payload:t,meta:r,error:i}}}function n(e){return function(t){var i=this;return function(n){var a=n.dispatch;return function(n){return function(o){return r.__awaiter(i,void 0,void 0,function(){var i,s,l,c,u,d,p;return r.__generator(this,function(r){switch(r.label){case 0:if(s=n(o),l=e[o.type],!l)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),u=(c=l).action,d={arg:o.payload.arg},[4,t.rpc(l.endpoint,o.payload.arg,o.payload.params)];case 2:return i=u.apply(c,[(d.result=r.sent(),d),o.meta]),[3,4];case 3:return p=r.sent(),i=l.action({arg:o.payload.arg,params:o.payload.params},o.meta,p),[3,4];case 4:return[2,a(i)];case 5:return[2,s]}})})}}}}}Object.defineProperty(t,"__esModule",{value:!0}),t._createAction=i,t._createMiddleware=n}),define("modules/clean/api_v2/redux/previews",["require","exports","modules/clean/api_v2/redux/base_action"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.Action={GetArchiveFiles:"@@apiv2_redux/previews/get_archive_files",GetArchiveFilesResult:"@@apiv2_redux/previews/get_archive_files_result",GetPreviewDataBatch:"@@apiv2_redux/previews/get_preview_data_batch",GetPreviewDataBatchResult:"@@apiv2_redux/previews/get_preview_data_batch_result",GetPreviewDataByFileIdsBatch:"@@apiv2_redux/previews/get_preview_data_by_file_ids_batch",GetPreviewDataByFileIdsBatchResult:"@@apiv2_redux/previews/get_preview_data_by_file_ids_batch_result",GetPreviewDataBySpecsBatch:"@@apiv2_redux/previews/get_preview_data_by_specs_batch",GetPreviewDataBySpecsBatchResult:"@@apiv2_redux/previews/get_preview_data_by_specs_batch_result",LoggedOutGetArchiveFiles:"@@apiv2_redux/previews/logged_out/get_archive_files",LoggedOutGetArchiveFilesResult:"@@apiv2_redux/previews/logged_out/get_archive_files_result"},t.getArchiveFilesAction=r._createAction(t.Action.GetArchiveFiles),t.getArchiveFilesResultAction=r._createAction(t.Action.GetArchiveFilesResult),t.getPreviewDataBatchAction=r._createAction(t.Action.GetPreviewDataBatch),t.getPreviewDataBatchResultAction=r._createAction(t.Action.GetPreviewDataBatchResult),t.getPreviewDataByFileIdsBatchAction=r._createAction(t.Action.GetPreviewDataByFileIdsBatch),t.getPreviewDataByFileIdsBatchResultAction=r._createAction(t.Action.GetPreviewDataByFileIdsBatchResult),t.getPreviewDataBySpecsBatchAction=r._createAction(t.Action.GetPreviewDataBySpecsBatch),t.getPreviewDataBySpecsBatchResultAction=r._createAction(t.Action.GetPreviewDataBySpecsBatchResult),t.loggedOutGetArchiveFilesAction=r._createAction(t.Action.LoggedOutGetArchiveFiles),t.loggedOutGetArchiveFilesResultAction=r._createAction(t.Action.LoggedOutGetArchiveFilesResult);var n=(i={},i[t.Action.GetArchiveFiles]={endpoint:"get_archive_files",action:t.getArchiveFilesResultAction},i[t.Action.GetPreviewDataBatch]={endpoint:"get_preview_data_batch",action:t.getPreviewDataBatchResultAction},i[t.Action.GetPreviewDataByFileIdsBatch]={endpoint:"get_preview_data_by_file_ids_batch",action:t.getPreviewDataByFileIdsBatchResultAction},i[t.Action.GetPreviewDataBySpecsBatch]={endpoint:"get_preview_data_by_specs_batch",action:t.getPreviewDataBySpecsBatchResultAction},i[t.Action.LoggedOutGetArchiveFiles]={endpoint:"logged_out/get_archive_files",action:t.loggedOutGetArchiveFilesResultAction},i);t.middleware=r._createMiddleware(n)}),define("modules/clean/api_v2/redux/users",["require","exports","modules/clean/api_v2/redux/base_action"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.Action={GetAccount:"@@apiv2_redux/users/get_account",GetAccountResult:"@@apiv2_redux/users/get_account_result",GetAccountBatch:"@@apiv2_redux/users/get_account_batch",GetAccountBatchResult:"@@apiv2_redux/users/get_account_batch_result",GetCurrentAccount:"@@apiv2_redux/users/get_current_account",GetCurrentAccountResult:"@@apiv2_redux/users/get_current_account_result",GetFileModifierAccount:"@@apiv2_redux/users/get_file_modifier_account",GetFileModifierAccountResult:"@@apiv2_redux/users/get_file_modifier_account_result",GetMobileClientSettings:"@@apiv2_redux/users/get_mobile_client_settings",GetMobileClientSettingsResult:"@@apiv2_redux/users/get_mobile_client_settings_result",GetPlanInfo:"@@apiv2_redux/users/get_plan_info",GetPlanInfoResult:"@@apiv2_redux/users/get_plan_info_result",GetRootInfo:"@@apiv2_redux/users/get_root_info",GetRootInfoResult:"@@apiv2_redux/users/get_root_info_result",GetSharingPrefs:"@@apiv2_redux/users/get_sharing_prefs",GetSharingPrefsResult:"@@apiv2_redux/users/get_sharing_prefs_result",GetSpaceUsage:"@@apiv2_redux/users/get_space_usage",GetSpaceUsageResult:"@@apiv2_redux/users/get_space_usage_result",GetUserUiInfo:"@@apiv2_redux/users/get_user_ui_info",GetUserUiInfoResult:"@@apiv2_redux/users/get_user_ui_info_result",NeedsScaleMitigation:"@@apiv2_redux/users/needs_scale_mitigation",NeedsScaleMitigationResult:"@@apiv2_redux/users/needs_scale_mitigation_result",SaveMobileClientSettings:"@@apiv2_redux/users/save_mobile_client_settings",SaveMobileClientSettingsResult:"@@apiv2_redux/users/save_mobile_client_settings_result",SetSharingPrefs:"@@apiv2_redux/users/set_sharing_prefs",SetSharingPrefsResult:"@@apiv2_redux/users/set_sharing_prefs_result"},t.getAccountAction=r._createAction(t.Action.GetAccount),t.getAccountResultAction=r._createAction(t.Action.GetAccountResult),t.getAccountBatchAction=r._createAction(t.Action.GetAccountBatch),t.getAccountBatchResultAction=r._createAction(t.Action.GetAccountBatchResult),t.getCurrentAccountAction=r._createAction(t.Action.GetCurrentAccount),t.getCurrentAccountResultAction=r._createAction(t.Action.GetCurrentAccountResult),t.getFileModifierAccountAction=r._createAction(t.Action.GetFileModifierAccount),t.getFileModifierAccountResultAction=r._createAction(t.Action.GetFileModifierAccountResult),t.getMobileClientSettingsAction=r._createAction(t.Action.GetMobileClientSettings),t.getMobileClientSettingsResultAction=r._createAction(t.Action.GetMobileClientSettingsResult),t.getPlanInfoAction=r._createAction(t.Action.GetPlanInfo),t.getPlanInfoResultAction=r._createAction(t.Action.GetPlanInfoResult),t.getRootInfoAction=r._createAction(t.Action.GetRootInfo),t.getRootInfoResultAction=r._createAction(t.Action.GetRootInfoResult),t.getSharingPrefsAction=r._createAction(t.Action.GetSharingPrefs),t.getSharingPrefsResultAction=r._createAction(t.Action.GetSharingPrefsResult),t.getSpaceUsageAction=r._createAction(t.Action.GetSpaceUsage),t.getSpaceUsageResultAction=r._createAction(t.Action.GetSpaceUsageResult),t.getUserUiInfoAction=r._createAction(t.Action.GetUserUiInfo),t.getUserUiInfoResultAction=r._createAction(t.Action.GetUserUiInfoResult),t.needsScaleMitigationAction=r._createAction(t.Action.NeedsScaleMitigation),t.needsScaleMitigationResultAction=r._createAction(t.Action.NeedsScaleMitigationResult),t.saveMobileClientSettingsAction=r._createAction(t.Action.SaveMobileClientSettings),t.saveMobileClientSettingsResultAction=r._createAction(t.Action.SaveMobileClientSettingsResult),t.setSharingPrefsAction=r._createAction(t.Action.SetSharingPrefs),t.setSharingPrefsResultAction=r._createAction(t.Action.SetSharingPrefsResult);var n=(i={},i[t.Action.GetAccount]={endpoint:"get_account",action:t.getAccountResultAction},i[t.Action.GetAccountBatch]={endpoint:"get_account_batch",action:t.getAccountBatchResultAction},i[t.Action.GetCurrentAccount]={endpoint:"get_current_account",action:t.getCurrentAccountResultAction},i[t.Action.GetFileModifierAccount]={endpoint:"get_file_modifier_account",action:t.getFileModifierAccountResultAction},i[t.Action.GetMobileClientSettings]={endpoint:"get_mobile_client_settings",action:t.getMobileClientSettingsResultAction},i[t.Action.GetPlanInfo]={endpoint:"get_plan_info",action:t.getPlanInfoResultAction},i[t.Action.GetRootInfo]={endpoint:"get_root_info",action:t.getRootInfoResultAction},i[t.Action.GetSharingPrefs]={endpoint:"get_sharing_prefs",action:t.getSharingPrefsResultAction},i[t.Action.GetSpaceUsage]={endpoint:"get_space_usage",action:t.getSpaceUsageResultAction},i[t.Action.GetUserUiInfo]={endpoint:"get_user_ui_info",action:t.getUserUiInfoResultAction},i[t.Action.NeedsScaleMitigation]={endpoint:"needs_scale_mitigation",action:t.needsScaleMitigationResultAction},i[t.Action.SaveMobileClientSettings]={endpoint:"save_mobile_client_settings",action:t.saveMobileClientSettingsResultAction},i[t.Action.SetSharingPrefs]={endpoint:"set_sharing_prefs",action:t.setSharingPrefsResultAction},i);t.middleware=r._createMiddleware(n)}),define("modules/clean/file_store/actions",["require","exports","tslib","modules/clean/file_store/types","modules/clean/file_store/utils","external/lodash"],function(e,t,r,i,n,a){"use strict";function o(e,t){return{type:i.FileNamespaceActions.PutFile,payload:{file:e,fileId:null!=t?t:n.getFileStoreId(e)}}}function s(e){var t=a.keyBy(e,n.getFileStoreId);return{type:i.FileNamespaceActions.PutFileMap,payload:t}}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),t.putFile=o,t.putFiles=s}),define("modules/clean/file_store/reducer",["require","exports","tslib","modules/clean/file_store/types"],function(e,t,r,i){"use strict";function n(e,n){void 0===e&&(e=t.defaultFileState);var a;switch(n.type){case i.FileNamespaceActions.PutFile:return r.__assign({},e,(a={},a[n.payload.fileId]=n.payload.file,a));case i.FileNamespaceActions.PutFileMap:return r.__assign({},e,n.payload)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFileState={},t.fileNamespaceReducer=n}),define("modules/clean/file_store/selectors",["require","exports","modules/clean/file_store/reducer","modules/clean/redux/types","modules/clean/redux/selectors"],function(e,t,r,i,n){"use strict";function a(e){return n.getStateAtNamespace(e,i.FILE_NAMESPACE_KEY)||r.defaultFileState}function o(e,t){return t?a(e)[t]:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getFile=o}),define("modules/clean/file_store/types",["require","exports","modules/clean/react/previews/archive/types","modules/clean/react/browse/model_types","modules/clean/shared_link/types"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveFile=r.File,t.BrowseFile=i.File,t.SharedFile=n.File,t.SharedFolder=n.Folder;(function(e){e.PutFile="PUT_FILE",e.PutFileMap="PUT_FILE_MAP"})(t.FileNamespaceActions||(t.FileNamespaceActions={}))}),define("modules/clean/file_store/utils",["require","exports","tslib","modules/clean/filepath"],function(e,t,r,i){"use strict";function n(e,t){return e.ns_id===t.ns_id&&e.sjid===t.sjid}function a(e){return"fq_path"in e}function o(e){return"subpath"in e}function s(e){return!a(e)&&!o(e)}function l(e){return d(e)}function c(e){return e.is_dir}function u(e){return e.is_dir&&"fq_path"in e}function d(e){return e.ns_id+":"+e.sjid}function p(e){var t="fq_path"in e?e.fq_path:e.filename;return i.file_extension(t)}function f(e){return c(e)?u(e)?i.filename(e.fq_path):e.filename:a(e)?i.filename(e.fq_path):e.filename}function v(e){var t=f(e);return i.filename_without_extension(t)}function _(e){return 0===e.bytes}function m(e){return e.is_symlink&&_(e)}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.areFilesEqual=n,t.isBrowseFile=a,t.isArchiveFile=o,t.isSharedFile=s,t.getFileStoreId=l,t.isFolder=c,t.isBrowseFolder=u,t.getFileRevisionId=d,t.getExtension=p,t.getFilename=f,t.getFilenameWithoutExtension=v,t.isEmptyFile=_,t.isSymLink=m}),define("modules/clean/open_in_app/types",["require","exports","tslib","modules/constants/file_viewer"],function(e,t,r,i){"use strict";function n(e){return e.platform===o.IPAD||e.platform===o.IPHONE}function a(e){return e.platform===o.ANDROID_MARKET}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i);var o=i.OpenInMobileAppPlatform;t.areUrlsIOS=n,t.areUrlsAndroid=a}),define("modules/clean/previews/api",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/api_v2/noauth_client","modules/clean/ajax_as_promised","modules/core/uri","file-viewer/core"],function(e,t,r,i,n,a,o,s){"use strict";function l(e,t){if(!t)return Promise.reject(new Error("user not logged in, no support for un-auth'd users yet"));var r={files:e.map(function(e){return{ns_id:e.ns_id,sj_id:e.sjid}})};return t?(new i.UserApiV2Client).ns("previews").rpc("get_preview_data_batch",r,{subjectUserId:t.id}):(new n.NoAuthApiV2Client).ns("previews").rpc("get_preview_data_batch",r,{})}function c(e){return void 0!==e.image}function u(e){var r=t.getParsedDropboxMetadataHeader(e.jqXHR);return 401===e.jqXHR.status&&"1"===e.jqXHR.getResponseHeader("x-dropbox-pdf-password-needed")?new s.RivieraError("Password required",s.RivieraStatus.PasswordProtected):new s.RivieraError("Load Error",r.rivieraStatusCode)}function d(e,t,i){return r.__awaiter(this,void 0,Promise,function(){var n,o,s,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.SilentBackgroundRequest({url:e,dataType:"json",type:"POST",data:i?{password:i}:{},xhrFields:{withCredentials:!0},skipInjectCsrf:f(e)})];case 1:return n=r.sent(),[3,3];case 2:throw o=r.sent(),u(o);case 3:return c(n)?[2,{text_url_tmpl:n.text,image_url_tmpl:n.image,refresh_url:n.refresh}]:(s=n.old_blob,l=n.new_blob,[2,{text_url_tmpl:t.text_url_tmpl.replace(s,l),image_url_tmpl:t.image_url_tmpl.replace(s,l),refresh_url:t.refresh_url.replace(s,l)}])}})})}function p(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.SilentBackgroundRequest({dataType:"json",type:"GET",url:e,xhrFields:{withCredentials:!0},skipInjectCsrf:f(e)})];case 1:return[2,r.sent()];case 2:throw t=r.sent(),u(t);case 3:return[2]}})})}function f(e){return o.URI.parse(e).getAuthority().toLocaleLowerCase().indexOf("dropbox.com")<0}Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),t.MAX_REQUEST_SIZE=50,t.fetchPreviewData=l,t.refreshBlob=d,t.requestDocMetadata=p,t.getParsedDropboxMetadataHeader=function(e){var t={};try{var r=e.getResponseHeader("x-dropbox-metadata");r&&(t=JSON.parse(r))}catch(e){}return t}}),define("modules/clean/previews/data/actions",["require","exports","tslib","external/lodash","modules/clean/previews/data/types","modules/clean/redux/types","modules/clean/previews/data/util","modules/clean/previews/api","modules/clean/file_store/utils","modules/clean/react/previews/pdf_viewer/urls"],function(e,t,r,i,n,a,o,s,l,c){"use strict";function u(e){var t={};return e.forEach(function(e){var r=l.getFileRevisionId(e),i=e.preview;i&&(t[r]={data:i,status:a.ApiClientStatus.Success})}),{type:n.ActionTypes.UpdatePreviewData,payload:t}}function d(e,t){var r=e.revision_id;return{type:n.ActionTypes.OverrideWithComments1Revision,payload:{revisionId:r,preview:t}}}function p(e){var t=e.revision_id;return{type:n.ActionTypes.ClearOverrideWithComments1Revision,payload:{revisionId:t}}}function f(e,t){var r,i=l.getFileRevisionId(e),a=(r={},r[i]={},r);return t.forEach(function(e){e.preview&&(a[i][e.subpath]=e.preview)}),{type:n.ActionTypes.PopulateArchiveFiles,payload:a}}function v(e,t,i){var n=this;return function(a,l){return r.__awaiter(n,void 0,void 0,function(){var n,c,u;return r.__generator(this,function(r){return n=o.filterFilesMissingPreviewData(l(),e,i),0===n.length?[2]:(c=o.chunkFiles(n,s.MAX_REQUEST_SIZE),u=c.map(function(e){return m(a,e,t)}),[2,Promise.all(u)])})})}}function _(e,t){return s.fetchPreviewData([e],t).then(function(e){if(e.results.length>0){var t=e.results[0].preview;if(t&&t.preview_url)return t.preview_url}})}function m(e,i,n){return r.__awaiter(this,void 0,void 0,function(){var a,o,l;return r.__generator(this,function(r){switch(r.label){case 0:a=g(i),e(t.apiRequestInFlightAction(a)),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.fetchPreviewData(i,n)];case 2:return o=r.sent(),[2,e(b(o))];case 3:return l=r.sent(),[2,e(y(a))];case 4:return[2]}})})}function g(e){return e.reduce(function(e,t){return e[l.getFileRevisionId(t)]={data:void 0,status:a.ApiClientStatus.Request},e},{})}function w(e,t){return e.reduce(function(e,r){return e[l.getFileRevisionId(r)]={data:r.preview,status:t},e},{})}function h(e){return{type:n.ActionTypes.UpdatePreviewData,payload:e}}function b(e){return{type:n.ActionTypes.UpdatePreviewData,payload:e.results.reduce(function(e,t){return e[o.buildRevisionId(t.file.ns_id,t.file.sj_id)]={data:t.preview||t.err,status:t.err||!t.preview?a.ApiClientStatus.Error:a.ApiClientStatus.Success},e},{})}}function y(e){return{type:n.ActionTypes.UpdatePreviewData,payload:i.mapValues(e,function(e){return{data:void 0,status:a.ApiClientStatus.Error}})}}function A(e,t){return{type:n.ActionTypes.RefreshDocBlobResult,payload:{revisionId:e,preview:t}}}function P(e,t,i,n){var a=this;return function(o){return r.__awaiter(a,void 0,void 0,function(){var a,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.refreshBlob(t,i,n)];case 1:return a=r.sent(),o(A(e,a)),o(x(e,a.text_url_tmpl)),[3,3];case 2:return l=r.sent(),o(F(e,void 0,l)),[3,3];case 3:return[2]}})})}}function F(e,t,r){return{type:n.ActionTypes.FetchDocMetadataResult,payload:{revisionId:e,metadata:t},error:r}}function S(e,t,r){return{type:n.ActionTypes.FetchDataForPageResult,payload:{revisionId:e,metadata:t},error:r}}function x(e,t){var i=this;return function(n){return r.__awaiter(i,void 0,void 0,function(){var i,a;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.requestDocMetadata(c.textUrl(t,!0))];case 1:return i=r.sent(),[3,3];case 2:return a=r.sent(),n(F(e,void 0,a)),[3,3];case 3:return n(F(e,i)),[2]}})})}}function I(e,t,i,n){var a=this;return function(o){return r.__awaiter(a,void 0,void 0,function(){var a,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.requestDocMetadata(c.textUrl(t,!1,i,n))];case 1:return a=r.sent(),o(S(e,a)),[3,3];case 2:return l=r.sent(),[3,3];case 3:return[2]}})})}}function R(){return{type:n.ActionTypes.ClearVirtualPreviewMetadata}}function D(e,t){var r=e.ns_id,i=e.sjid;return{type:n.ActionTypes.SetVirtualPreviewMetadata,payload:{revisionId:o.buildRevisionId(r,i),preview:t}}}function M(e){var t=e.ns_id,r=e.sjid;return{type:n.ActionTypes.ApplyVirtualPreviewMetadata,payload:o.buildRevisionId(t,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.populateFilesPreviewData=u,t.overridePreviewForComments=d,t.clearCommentsPreviewOverride=p,t.populateArchivePreviews=f,t.fetchPreviewData=v,t.fetchPreviewUrl=_,t.buildPreviewData=w,t.updatePreviewData=h,t.apiRequestInFlightAction=h,t.apiRequestSuccessAction=b,t.apiRequestErrorAction=y,t.refreshBlobAction=P,t.fetchDocMetadataResultAction=F,t.fetchDataForPageResultAction=S,t.fetchDocMetadata=x,t.fetchDataForPage=I,t.clearVirtualPreviewMetadata=R,t.setVirtualPreviewMetadata=D,t.applyVirtualPreviewMetadata=M}),define("modules/clean/previews/data/reducer",["require","exports","tslib","external/lodash","modules/clean/previews/data/types","modules/clean/react/previews/pdf_viewer/urls"],function(e,t,r,i,n,a){"use strict";function o(e){if(!e||!e.pages)return{};var t=e.links,i=e.schema_version,n=e.pages,a=e.fonts,o=void 0===a?[]:a,s=Object.keys(n),l={schema_version:i,links:t,pages:{}};return s.filter(function(e){return!!n[e]}).forEach(function(e){l.pages[e]=n[e].map(function(e){return r.__assign({},e,{font:o[e.f]})})}),l}function s(e,s){void 0===e&&(e=t.initialState);var c,u,d,p,f,v,_,m,g,w;switch(s.type){case n.ActionTypes.PopulateArchiveFiles:return r.__assign({},e,{archivePreviews:i.merge({},e.archivePreviews,s.payload)});case n.ActionTypes.ClearVirtualPreviewMetadata:return r.__assign({},e,{virtualPreviews:{}});case n.ActionTypes.SetVirtualPreviewMetadata:var h=s.payload,b=h.preview,y=h.revisionId;return r.__assign({},e,{virtualPreviews:i.merge({},e.virtualPreviews,(c={},
c[y]=b,c))});case n.ActionTypes.ApplyVirtualPreviewMetadata:var A=s.payload;return r.__assign({},e,{filePreviews:i.merge({},e.filePreviews,(u={},u[A]={data:e.virtualPreviews[A]},u)),virtualPreviews:i.omit(e.virtualPreviews,A)});case n.ActionTypes.UpdatePreviewData:return r.__assign({},e,{filePreviews:r.__assign({},e.filePreviews,s.payload)});case n.ActionTypes.OverrideWithComments1Revision:return w=s.payload.revisionId,r.__assign({},e,{comments1Override:r.__assign({},e.comments1Override,(d={},d[w]=s.payload.preview,d))});case n.ActionTypes.ClearOverrideWithComments1Revision:return r.__assign({},e,{comments1Override:r.__assign({},e.comments1Override,(p={},p[s.payload.revisionId]=void 0,p))});case n.ActionTypes.RefreshDocBlobResult:return w=s.payload.revisionId,r.__assign({},e,{filePreviews:r.__assign({},e.filePreviews,(f={},f[w]=r.__assign({},e.filePreviews[w],{data:r.__assign({},e.filePreviews[w].data,{content:r.__assign({},e.filePreviews[w].data.content,s.payload.preview,{placeholder_image_url:s.payload.preview.placeholder_image_url||a.imageUrl(s.payload.preview.image_url_tmpl)})})}),f))});case n.ActionTypes.FetchDocMetadataResult:if(w=s.payload.revisionId,s.error)return r.__assign({},e,{docPreviewMetadata:r.__assign({},e.docPreviewMetadata,(v={},v[w]={metadata:l,text:{},error:s.error},v))});if(s.payload.metadata){var P=s.payload.metadata,F=P.metadata,S=void 0===F?l:F,x=P.text,I={},R=e.docPreviewMetadata[w];return S&&(S=r.__assign({},R&&R.metadata||{},S)),x&&(I=r.__assign({},R&&R.text||{},o(x))),r.__assign({},e,{docPreviewMetadata:r.__assign({},e.docPreviewMetadata,(_={},_[w]={metadata:S,text:I},_))})}return e;case n.ActionTypes.FetchDataForPageResult:w=s.payload.revisionId;var R=e.docPreviewMetadata[w]||{metadata:l,text:{}};if(s.error)return r.__assign({},e,{docPreviewMetadata:r.__assign({},e.docPreviewMetadata,(m={},m[w]=r.__assign({},R,{error:s.error}),m))});if(s.payload.metadata){var D=s.payload.metadata,S=D.metadata,x=D.text,I={};if(S=S?i.merge({},R.metadata,S):R.metadata,x){var M=o(x);I=i.merge({},R.text,M)}else I=R.text;return r.__assign({},e,{docPreviewMetadata:r.__assign({},e.docPreviewMetadata,(g={},g[w]={metadata:S,text:I},g))})}return e;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.initialState={filePreviews:{},docPreviewMetadata:{},comments1Override:{},archivePreviews:{},virtualPreviews:{}};var l={schema_version:0,page_count:0,dimensions:[]};t.reducer=s}),define("modules/clean/previews/data/selectors",["require","exports","modules/clean/redux/types","modules/clean/redux/selectors","modules/clean/file_store/utils"],function(e,t,r,i,n){"use strict";function a(e){return i.getStateAtNamespace(e,r.PREVIEW_NAMESPACE_KEY)}function o(e,t){var r=a(e);return r&&t?r.comments1Override[t]||r.virtualPreviews[t]||r.filePreviews[t]&&r.filePreviews[t].data:{}}function s(e,t){var r=a(e);return!(!r||!t)&&(!r.comments1Override[t]&&!!r.virtualPreviews[t])}function l(e,t){var i=a(e);if(!i||!t)return p;var o=n.getFileRevisionId(t),s=i.comments1Override[t.revision_id];if(s)return{data:s,status:r.ApiClientStatus.Success};if(i.virtualPreviews[o])return{data:i.virtualPreviews[o],status:r.ApiClientStatus.Success};var l=i.filePreviews[o];return l&&l.status?l:p}function c(e,t){return t.reduce(function(t,r){return t[n.getFileRevisionId(r)]=l(e,r),t},{})}function u(e,t){var a=i.getStateAtNamespace(e,r.PREVIEW_NAMESPACE_KEY);if(!a||!t)return p;var o=a.archivePreviews[n.getFileRevisionId(t)];return o?{data:o[t.subpath],status:r.ApiClientStatus.Success}:p}function d(e,t){var n=i.getStateAtNamespace(e,r.PREVIEW_NAMESPACE_KEY);if(n)return n.docPreviewMetadata[t]}Object.defineProperty(t,"__esModule",{value:!0});var p={data:void 0,status:r.ApiClientStatus.Error};t.getApiDataForRevisionId=o,t.getIsVirtualRevisionId=s,t.getApiDataForFile=l,t.getApiDataForFiles=c,t.getPreviewForArchiveFile=u,t.getDocMetadataByRevisionId=d}),define("modules/clean/previews/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.PopulateArchiveFiles="FileViewer/Previews/PopulateArchiveFiles",e.UpdatePreviewData="FileViewer/Previews/UpdatePreviewData",e.OverrideWithComments1Revision="FileViewer/Previews/OverrideWithComments1Revision",e.ClearOverrideWithComments1Revision="FileViewer/Previews/ClearOverrideWithComments1Revision",e.RefreshDocBlob="FileViewer/Previews/RefreshDocBlob",e.RefreshDocBlobResult="FileViewer/Previews/RefreshDocBlobResult",e.FetchDocMetadata="FileViewer/Previews/FetchDocMetadata",e.FetchDocMetadataResult="FileViewer/Previews/FetchDocMetadataResult",e.FetchDataForPageResult="FileViewer/Previews/FetchDataForPageResult",e.ApplyVirtualPreviewMetadata="FileViewer/Previews/ApplyVirtualPreviewMetadata",e.ClearVirtualPreviewMetadata="FileViewer/Previews/ClearVirtualPreviewMetadata",e.SetVirtualPreviewMetadata="FileViewer/Previews/SetVirtualPreviewMetadata"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/previews/data/util",["require","exports","tslib","external/lodash","modules/clean/previews/data/selectors","modules/clean/file_store/utils","modules/clean/redux/types"],function(e,t,r,i,n,a,o){"use strict";function s(e,t,r){if(void 0===r&&(r=!1),r)return t;var s=n.getApiDataForFiles(e,t);return i.filter(t,function(e){var t=a.getFileRevisionId(e);return!e.is_dir&&(!s[t]||!s[t].data&&s[t].status===o.ApiClientStatus.Error)})}function l(e,t){return e+":"+t}function c(e,t){var r=n.getApiDataForFile(e,t);return!(!r||!r.data||r.status===o.ApiClientStatus.Error)}function u(e,t){return d(e,t)===o.ApiClientStatus.Request}function d(e,t){var r=n.getApiDataForFile(e,t);return r?r.status:void 0}function p(e,t){if(e.length<=0)return[];if(e.length<t)return[e];for(var r=Array(Math.ceil(e.length/t)),i=0,n=0;i<e.length;)r[n++]=e.slice(i,i+=t);return r}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),t.filterFilesMissingPreviewData=s,t.buildRevisionId=l,t.previewDataPresentForFile=c,t.previewDataInFlight=u,t.previewDataStatus=d,t.chunkFiles=p}),define("modules/clean/react/browse/model_types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("modules/clean/react/previews/archive/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("modules/clean/react/previews/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.LoadError="LOAD_ERROR",e.SupportError="SUPPORT_ERROR",e.ExtensionError="EXTENSION_ERROR",e.NeedFlashError="NEED_FLASH_ERROR",e.FileSizeError="FILE_SIZE_ERROR",e.PasswordProtectedError="PASSWORD_PROTECTED_ERROR",e.PendingUploadError="PENDING_UPLOAD_ERROR",e.EmptyFileError="EMPTY_FILE_ERROR",e.SymLinkError="SYM_LINK_ERROR",e.WatermarkingError="WATERMARKING_ERROR"})(t.ErrorType||(t.ErrorType={}));(function(e){e.Browse="browse",e.Home="home",e.SharedLinkFile="sl_file",e.SharedLinkFolder="sl_folder",e.SharedLinkCollection="sl_collection",e.VersionHistory="version_history",e.FileViewer="file_viewer",e.Desktop="desktop",e.EmbeddedSharedLinkFile="embedded_sl_file",e.ArchiveFile="archive_file"})(t.PreviewSourceContext||(t.PreviewSourceContext={}));(function(e){e.Visit="visit",e.Click="click",e.FileViewerExit="file_viewer_exit"})(t.PreviewSourceAction||(t.PreviewSourceAction={}));(function(e){e.Unknown="unknown",e.NewFile="new_file",e.BeforeUnload="before_unload",e.Unmount="unmount"})(t.PreviewSessionEndReason||(t.PreviewSessionEndReason={}));(function(e){e.EnableRegionCreation="EnableRegionCreation",e.Fullscreen="Fullscreen",e.PageDown="PageDown",e.PageIndicator="PageIndicator",e.PageUp="PageUp",e.Print="Print",e.Sidebar="Sidebar",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.Esignature="Esignature",e.FlipControls="FlipControls"})(t.PreviewToolbarButtonType||(t.PreviewToolbarButtonType={}))}),define("modules/clean/react/previews/pdf_viewer/urls",["require","exports","tslib","modules/core/uri","modules/constants/file_viewer"],function(e,t,r,i,n){"use strict";function a(e,t,r,i,n){return void 0===r&&(r=0),void 0===i&&(i=50),void 0===n&&(n=!1),t&&(e=s(e,{metadata:"1"})),void 0!==r&&(e=s(e,{text:"1",page_start:""+r,page_end:""+i})),n&&(e=s(e,{canned_file_name:"spdf/audi.pdf.json"})),e}function o(e,t,r,i){void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=!1);var a={page:t.toString()};n.SVG_PDF_PREVIEW&&r>0?a.format="svg":a.scale_percent=r.toString();var o=s(e,a);return i&&(o=s(o,{canned_file_name:"spdf/audi.pdf."+t+".png"})),o}function s(e,t){return i.URI.parse(e).updateQuery(t).toString()}function l(e){return i.URI.parse(e).getAuthority().toLocaleLowerCase().indexOf("dropbox.com")<0}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.textUrl=a,t.imageUrl=o,t.updateQueryParam=s,t.skipCsrfTokenInjection=l}),define("modules/clean/shared_link/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=pkg-previews_core.min.js-vflSFsog-.map