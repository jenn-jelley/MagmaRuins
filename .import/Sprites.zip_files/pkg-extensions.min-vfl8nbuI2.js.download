var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};define("modules/clean/react/app_actions/app_actions_menu",["require","exports","modules/clean/react/async/loadable"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsMenu=n.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/app_actions/app_actions_menu_component"],t,n)}).then(__importStar).then(function(e){return e.ExtensionsMenu})}}),t.UnconnectedExtensionsMenu=n.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/app_actions/unconnected_menu"],t,n)}).then(__importStar).then(function(e){return e.UnconnectedMenu})}})}),define("modules/clean/react/app_actions/category",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={0:{displayName:n._("DEFAULT")},1:{displayName:n._("Send for signature"),developerDescription:n._("Send for signature")},2:{displayName:n._("PDF Editing"),developerDescription:n._("PDF editing")},3:{displayName:n._("View or Edit"),developerDescription:n._("View or edit")},4:{displayName:n._("Image Editing"),developerDescription:n._("Image editing")},5:{displayName:n._("Video comment"),developerDescription:n._("Video comment")},6:{displayName:n._("Send fax"),developerDescription:n._("Send fax")},7:{displayName:n._("Open With Cloud Doc"),developerDescription:n._("Open With Cloud Doc")}};(function(e){function t(e){return i[e]||null}function n(e){var n=t(e);return n&&n.displayName}function r(e){var n=t(e);return n&&n.developerDescription||null}e.DEFAULT=0,e.ESIGNATURE=1,e.PDF_EDITING=2,e.VIEW_OR_EDIT=3,e.IMAGE_EDITING=4,e.VIDEO_COMMENT=5,e.SEND_FAX=6,e.OPEN_WITH_CLOUD_DOC=7,e.getDisplayName=n,e.getDeveloperDescription=r})(t.Category||(t.Category={}))}),define("modules/clean/react/app_actions/data/action_creators",["require","exports","tslib","modules/clean/react/extensions/client","modules/clean/react/app_actions/data/types"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtensionConfigWithNewFiles=function(e){var o=e.files,a=e.user;return function(e,s){return n.__awaiter(this,void 0,void 0,function(){var s,c,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.getExtensionsClient().getActionsForFileBatch(o,a.id)];case 1:return s=n.sent(),e(t.setExtensionsFeatureFlags({featureFlags:i.getExtensionsClient().getFeatureFlags()})),c=i.getExtensionsClient().getAppIcons(),e({type:r.ActionTypes.REFRESH_ICONS,payload:{icons:c}}),u=i.getExtensionsClient().getSharingServiceInfo(),e({type:r.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:u}}),e({type:r.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:s}}),e(t.setLoadedState({clientLoaded:i.getExtensionsClient().getLoadedState()})),[2]}})})}},t.setExtensionsFeatureFlags=function(e){var t=e.featureFlags;return{type:r.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS,payload:{featureFlags:t}}},t.setLoadedState=function(e){var t=e.clientLoaded;return{type:r.ActionTypes.SET_LOADED_STATE,payload:{clientLoaded:t}}},t.refreshAppIcons=function(e){var t=e.user;return function(e,o){return n.__awaiter(this,void 0,void 0,function(){var o;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.getExtensionsClient().refreshAppIcons(t.id)];case 1:return n.sent(),o=i.getExtensionsClient().getAppIcons(),e({type:r.ActionTypes.REFRESH_ICONS,payload:{icons:o}}),[2]}})})}},t.updateLinkState=function(e){var t=e.actionId,o=e.linkState;return function(e,a){return n.__awaiter(this,void 0,void 0,function(){var a,s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.getExtensionsClient()];case 1:return a=n.sent(),a.updateLinkStateForAction(t,o),s=a.extensionsConfigsForTrackedFiles(),e({type:r.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:s}}),[2]}})})}},t.refreshSharingServiceInfo=function(e){var t=e.user,o=e.onRefresh;return function(e,a){return n.__awaiter(this,void 0,void 0,function(){var a,s,c;return n.__generator(this,function(n){switch(n.label){case 0:return a=i.getExtensionsClient(),[4,a.refreshSharingServiceInfo(t.id)];case 1:return n.sent(),[4,i.getExtensionsClient().getSharingServiceInfo()];case 2:return s=n.sent(),o&&o(s),e({type:r.ActionTypes.SET_SHARING_SERVICE_INFO_STATE,payload:{sharingServiceInfo:s}}),c=a.extensionsConfigsForTrackedFiles(),e({type:r.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES,payload:{fileExtensionsConfigs:c}}),[2]}})})}},t.setInDownloadInterceptFlow=function(e){var t=e.inDownloadInterceptFlow;return{type:r.ActionTypes.SET_IN_DOWNLOAD_INTERCEPT_FLOW,payload:{inDownloadInterceptFlow:t}}},t.setInUploadInterceptFlow=function(e){var t=e.uploadInterceptFlowFileId;return{type:r.ActionTypes.SET_IN_UPLOAD_INTERCEPT_FLOW,payload:{uploadInterceptFlowFileId:t}}}}),define("modules/clean/react/app_actions/data/reducer",["require","exports","tslib","modules/clean/react/app_actions/data/types"],function(e,t,n,i){"use strict";function r(e,n){switch(void 0===e&&(e=t.defaultExtensionsState),n.type){case i.ActionTypes.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES:return o(e,n);case i.ActionTypes.SET_EXTENSIONS_FEATURE_FLAGS:return a(e,n);case i.ActionTypes.REFRESH_ICONS:return s(e,n);case i.ActionTypes.SET_LOADED_STATE:return c(e,n);case i.ActionTypes.SET_SHARING_SERVICE_INFO_STATE:return u(e,n);case i.ActionTypes.SET_IN_DOWNLOAD_INTERCEPT_FLOW:return l(e,n);case i.ActionTypes.SET_IN_UPLOAD_INTERCEPT_FLOW:return p(e,n)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultExtensionsState={fileExtensionsConfigs:{},featureFlags:{},appIcons:{},clientLoaded:!1,sharingServiceInfo:{},inDownloadInterceptFlow:!1,uploadInterceptFlowFileId:void 0};var o=function(e,t){var i=t.payload.fileExtensionsConfigs;return n.__assign({},e,{fileExtensionsConfigs:n.__assign({},e.fileExtensionsConfigs,i)})},a=function(e,t){var i=t.payload.featureFlags;return n.__assign({},e,{featureFlags:i})},s=function(e,t){var i=t.payload.icons;return n.__assign({},e,{appIcons:i})},c=function(e,t){var i=t.payload.clientLoaded;return n.__assign({},e,{clientLoaded:i})},u=function(e,t){var i=t.payload.sharingServiceInfo;return n.__assign({},e,{sharingServiceInfo:i})},l=function(e,t){var i=t.payload.inDownloadInterceptFlow;return n.__assign({},e,{inDownloadInterceptFlow:i})},p=function(e,t){var i=t.payload.uploadInterceptFlowFileId;return n.__assign({},e,{uploadInterceptFlowFileId:i})};t.extensionsReducer=r}),define("modules/clean/react/app_actions/data/selectors",["require","exports","modules/clean/redux/types","modules/clean/redux/selectors","modules/clean/react/app_actions/data/reducer"],function(e,t,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionsState=function(e){return i.getStateAtNamespace(e,n.EXTENSIONS_NAMESPACE_KEY)||r.defaultExtensionsState},t.fileExtensionsConfigs=function(e){return t.getExtensionsState(e).fileExtensionsConfigs},t.extensionsFeatureFlags=function(e){return t.getExtensionsState(e).featureFlags},t.getAppIcons=function(e){return t.getExtensionsState(e).appIcons},t.isLoaded=function(e){return t.getExtensionsState(e).clientLoaded},t.sharingServiceInfo=function(e){return t.getExtensionsState(e).sharingServiceInfo},t.inDownloadInterceptFlow=function(e){return t.getExtensionsState(e).inDownloadInterceptFlow},t.uploadInterceptFlowFileId=function(e){return t.getExtensionsState(e).uploadInterceptFlowFileId}}),define("modules/clean/react/app_actions/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES="EXTENSIONS/UPDATE_EXTENSIONS_CONFIG_WITH_NEW_FILES",e.SET_EXTENSIONS_FEATURE_FLAGS="EXTENSIONS/SET_EXTENSIONS_FEATURE_FLAGS",e.REFRESH_ICONS="EXTENSIONS/REFRESH_ICONS",e.SET_LOADED_STATE="EXTENSIONS/SET_LOADED_STATE",e.UPDATE_LINK_STATE="EXTENSIONS/UPDATE_LINK_STATE",e.SET_SHARING_SERVICE_INFO_STATE="EXTENSIONS/SET_SHARING_SERVICE_INFO_STATE",e.SET_IN_DOWNLOAD_INTERCEPT_FLOW="EXTENSIONS/SET_IN_DOWNLOAD_INTERCEPT_FLOW",e.SET_IN_UPLOAD_INTERCEPT_FLOW="EXTENSIONS/SET_IN_UPLOAD_INTERCEPT_FLOW"})(t.ActionTypes||(t.ActionTypes={}));(function(e){e.PrimaryButton="primary_button",e.SecondaryButton="secondary_button",e.SidebarLink="sidebar_link",e.SidebarPrimaryButton="sidebar_primary_button"})(t.TriggerType||(t.TriggerType={}))}),define("modules/clean/react/app_actions/feedback_modal",["require","exports","tslib","modules/clean/ajax","react","modules/clean/react/css","modules/clean/react/image","spectrum/button","modules/core/i18n","modules/clean/react/modal","spectrum/input","modules/clean/static_urls","modules/clean/filepath","modules/clean/file_store/utils","spectrum/dropdown_menu","dropins_sdk_refactor/dropins_sdk_internal","modules/constants/dropins"],function(e,t,n,i,r,o,a,s,c,u,l,p,d,_,f,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),r=n.__importDefault(r),t.bugReport=c._("Report a problem"),t.suggestSomething=c._("Suggest something");var m="extensions-feedback",E=[t.bugReport,t.suggestSomething],S=(function(e){function o(n){var o=e.call(this,n)||this;return o.submitFeedback=function(){var e=o.state.detailsText;if(o.state.screenshotLinks.length>0){e+=" (Screenshot links: "+o.state.screenshotLinks.join("; ")+")"}if(o.state.category===t.bugReport){var n="[Extensions]"+o.state.subjectText;i.SilentBackgroundRequest({url:"/support_ajax/support_form",data:{user_email:o.props.user.email,subject_posted:n,details_posted:e}})}else i.SilentBackgroundRequest({url:"/aa/app_choice_feedback",subject_user:o.props.user.id,data:{ext:o.getFileExt(),other_suggested_apps:o.state.subjectText,comments:e,surface:o.props.surface||"unknown",menu_contents:o.props.visibleMenuItems?o.props.visibleMenuItems.join(", "):""}});o.setState({showThankYouModal:!0})},o.handleSubjectChanged=function(e){o.setState({subjectText:e.currentTarget.value.trim()})},o.handleDetailsChanged=function(e){o.setState({detailsText:e.currentTarget.value.trim()})},o.handleChooseFromDropbox=function(){g.Dropbox.choose({linkType:"preview",multiselect:!0,success:function(e){var t=e.map(function(e){return e.link}),n=e.map(function(e){return e.name});o.setState({screenshotLinks:t,attachmentNames:n})},extensions:["images","video"]})},o.isAnyFeedbackInput=function(){return o.state.subjectText.length>0||o.state.detailsText.length>0},o.handleCategoryChange=function(e){o.setState({category:e})},o.renderFeedbackModel=function(){return r.default.createElement(u.Modal,{className:m+"-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean",autoFocusPrimaryInput:!1,width:560},r.default.createElement("div",{className:m+"-inputs"},r.default.createElement("div",{className:m+"-title"},r.default.createElement("h1",{className:m+"-modal-header"},c._("Send feedback"))),r.default.createElement("div",{className:m+"-container"},r.default.createElement(f.DropdownMenu,{id:"select--category",className:m+"-category-selector",onSelection:o.handleCategoryChange},r.default.createElement(f.DropdownMenuButton,{fullWidth:!0,className:"menu-button"},o.state.category),r.default.createElement(f.Menu,null,o.renderCategoryItems())),r.default.createElement("label",{htmlFor:m+"-subject-input",className:m+"-label"},c._("Subject")),r.default.createElement(l.Input,{id:"subject-input",className:m+"-subject-input",onChange:o.handleSubjectChanged,"aria-label":c._("subject input")}),r.default.createElement("label",{htmlFor:m+"-details-input",className:m+"-label"},c._("Details")),r.default.createElement("textarea",{id:"details-input",className:m+"-details-input",onChange:o.handleDetailsChanged,"aria-label":c._("details input"),rows:4}),r.default.createElement(s.Button,{variant:"secondary",className:m+"-screenshot-button",onClick:o.handleChooseFromDropbox},c._("Add a screenshot")),o.renderSelectedScreenshot())),r.default.createElement("div",{className:m+"-action-bar"},r.default.createElement(s.Button,{variant:"secondary",className:"action-bar-cancel-button",onClick:o.props.onBack},c._("Cancel")),r.default.createElement("div",{className:m+"-action-bar-space"}),r.default.createElement(s.Button,{variant:"primary",className:"action-bar-submit-button",disabled:!o.isAnyFeedbackInput(),onClick:o.submitFeedback},c._("Submit"))))},o.renderThankYouModal=function(){return r.default.createElement(u.Modal,{className:m+"-thank-you-modal",ariaLabel:"Feedback Modal",acceptButtonText:null,style:"clean"},r.default.createElement(a.Image,{className:m+"-thank-you-image",alt:c._("Thank you"),src:p.static_url("/static/images/app_actions/feedback_comments-vfluWMAvS.png"),srcHiRes:p.static_url("/static/images/app_actions/feedback_comments@2x-vflWa-9nT.png")}),r.default.createElement("h1",{className:m+"-thank-you-header"},c._("Thanks for letting us know!")),r.default.createElement("h2",{className:m+"-thank-you-subtext"},c._("Your feedback will help make Dropbox even better.")))},o.state={category:t.bugReport,subjectText:"",detailsText:"",screenshotLinks:[],attachmentNames:[],showThankYouModal:!1},g.Dropbox.init({appKey:h.CHOOSER_APP_KEY}),o}return n.__extends(o,e),o.prototype.getFileExt=function(){var e=this.props.file;return void 0===e?null:_.isSharedFile(e)&&e.filename?d.file_extension(e.filename):_.isBrowseFile(e)&&e.ext?e.ext:""},o.prototype.renderCategoryItems=function(){var e=this;return E.map(function(t){return r.default.createElement(f.MenuItem,{value:t,key:t,selected:e.state.category===t},t)})},o.prototype.renderSelectedScreenshot=function(){return this.state.attachmentNames.map(function(e){return r.default.createElement("p",null,e)})},o.prototype.render=function(){return this.state.showThankYouModal?this.renderThankYouModal():this.renderFeedbackModel()},o})(r.default.Component);t.FeedbackModal=o.requireCssWithComponent(S,["/static/css/app_actions/index-vfl4JQL7D.css"])}),define("modules/clean/react/app_actions/telemetry_client",["require","exports","tslib","modules/clean/logging/telemetry","modules/clean/logging/hive/schemas/web-app_actions_telemetry"],function(e,t,n,i,r){"use strict";function o(e){return new u(l,e)}function a(e){for(var t={},n=0,i=e;n<i.length;n++){t[i[n]]=!0}return t}function s(e){return p[e]?e:"__REDACTED__"}Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var c=(function(){function e(t,n){this.logger=t,this.context=n,this.sessionId=e.generateRandomId()}return e.generateRandomId=function(){return Math.random().toString(36).substring(2)},e.getCurrentTimestamp=function(){return(new Date).getTime()},e.prototype.event=function(t,i){var o=e.getCurrentTimestamp(),a=n.__assign({},this.context,i),s=new r.AppActionsTelemetryRow({telemetry_session_id:this.sessionId,event_name:t,event_start_ts:o,event_extras:JSON.stringify(a)});this.logger.log(s)},e})();t.Session=c;var u=(function(){function e(e,t){this.logger=e,this.context=t||{}}return e.prototype.session=function(e){var t=n.__assign({},this.context,e);return new c(this.logger,t)},e})();t.TelemetryClient=u;var l=new i.HiveLogger;t.createTelemetryClient=o;var p=a(["",".doc",".docx",".pdf",".dwg",".png",".jpg",".jpeg",".tiff",".m4v",".wmv",".mpg",".pptx",".xlsx",".pages",".numbers",".key"]);t.getPiiSafeExtension=s}),define("modules/clean/react/extensions/client",["require","exports","tslib","external/lodash","modules/clean/api_v2/user_client","modules/clean/react/extensions/feature_flags","modules/clean/react/extensions/file"],function(e,t,n,i,r,o,a){"use strict";function s(e){return"app_id"in e}function c(){return l("",[])}function u(e,t){return e.priority&&t.priority?t.priority-e.priority:e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0}function l(e,t,n,i,r,o){return void 0===n&&(n=d.DISABLED),void 0===i&&(i={}),void 0===r&&(r={}),void 0===o&&(o={}),{fileId:e,actionCategories:t,displayState:n,bylines:i,featureFlags:r,sharingServiceInfo:o}}function p(){return f||(f=new _(new r.UserApiV2Client)),f}Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.isAppId=s;var d;(function(e){e[e.LOADING=0]="LOADING",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED"})(d=t.DisplayState||(t.DisplayState={})),t.emptyExtensionsConfig=c,t.newExtensionsConfig=l;var _=(function(){function e(e){this.trackedFiles=new Map,this.loaded=!1,this.state={actionIdToAppAction:{},appActionAppIcons:{},appActionsEnabled:!1,bylines:{},categoryMapsByExt:{},featureFlags:{},sharingServiceInfo:{}},this.parseCategoryActionGroupsFromState=i.memoize(function(e){var t={},n=function(n){if(e.categoryMapsByExt.hasOwnProperty(n)){var i=new Array;e.categoryMapsByExt[n].forEach(function(t,n){var r=t.map(function(t){return e.actionIdToAppAction[t]}).sort(u);i.push({categoryId:n,actions:r})}),t[n]=i}};for(var i in e.categoryMapsByExt)n(i);return t}),this.client=e}return e.prototype.getActionsForFile=function(e,t){return n.__awaiter(this,void 0,Promise,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.getActionsForFileBatch([e],t)];case 1:return i=n.sent(),[2,i[e.file_id]||c()]}})})},e.prototype.getActionsForFileBatch=function(e,t){return n.__awaiter(this,void 0,Promise,function(){var i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this.loadState(t)];case 1:return i=n.sent(),[2,this.getExtensionsConfigsForFiles(i,e)]}})})},e.prototype.getAppIcons=function(){return n.__assign({},this.state.appActionAppIcons)},e.prototype.refreshAppIcons=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,i,r,o,a;return n.__generator(this,function(s){switch(s.label){case 0:t=void 0,i=this.iconRequest,s.label=1;case 1:return s.trys.push([1,6,,7]),i?[4,i]:[3,3];case 2:return t=s.sent(),[3,5];case 3:return r=Object.keys(this.state.appActionAppIcons),i=this.client.ns("app_actions").rpc("get_app_icons",{app_ids:r},{subjectUserId:e}),this.iconRequest=i,[4,i];case 4:t=s.sent(),s.label=5;case 5:return[3,7];case 6:return o=s.sent(),[3,7];case 7:return this.iconRequest=void 0,t&&(a=n.__assign({},this.state.appActionAppIcons),t.icons.forEach(function(e){a[e.app_id]=e.icon}),this.state=n.__assign({},this.state,{appActionAppIcons:a})),[2]}})})},e.prototype.getFeatureFlags=function(){return this.state.featureFlags},e.prototype.getLoadedState=function(){return this.loaded},e.prototype.updateLinkStateForAction=function(e,t){var i=this.state.actionIdToAppAction[e];if(i){var r=n.__assign({},this.state.actionIdToAppAction);r[e]=n.__assign({},i,{link_state:t}),this.state=n.__assign({},this.state,{actionIdToAppAction:r})}},e.prototype.extensionsConfigsForTrackedFiles=function(){var e=[];return this.trackedFiles.forEach(function(t){return e.push(t)}),this.getExtensionsConfigsForFiles(this.state,e)},e.prototype.loadState=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,i,r;return n.__generator(this,function(n){switch(n.label){case 0:if(this.loaded)return[3,4];this.stateRequest||(this.stateRequest=this.fetchActions(e)),t=this.stateRequest,n.label=1;case 1:return n.trys.push([1,3,,4]),i=this,[4,this.stateRequest];case 2:return i.state=n.sent(),[3,4];case 3:return r=n.sent(),this.stateRequest===t&&(this.stateRequest=void 0),[3,4];case 4:return[2,this.state]}})})},e.prototype.getExtensionsConfigsForFiles=function(e,t){var n=this,i={},r=this.parseCategoryActionGroupsFromState(e);return t.forEach(function(t){var o=a.getFileExt(t),s=void 0;o&&(s=r[o]),i[t.file_id]=l(t.file_id,s||[],e.appActionsEnabled&&!t.is_dir?d.ENABLED:d.DISABLED,e.bylines,e.featureFlags,e.sharingServiceInfo),n.trackedFiles.set(t.file_id,t)}),i},e.prototype.fetchActions=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,i,r,a,c,u,l,p,d,_;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this.client.ns("app_actions").rpc("get_actions_for_user",{},{subjectUserId:e}),[4,Promise.all([t,this.refreshSharingServiceInfo(e)])];case 1:return i=n.sent(),r=i[0],a=i[1],c={},u={},r.actions.forEach(function(e){c[e.id]||(c[e.id]=e,u[e.app_id]=e.icon)}),l={},r.action_mapping.forEach(function(e){var t=e.matcher;if("extension"===t[".tag"]){var n=t.extension,i=new Map;e.action_ids.forEach(function(e){var t=c[e],n=i.get(t.category);n?n.push(t.id):(n=[t.id],i.set(t.category,n))}),l[n]=i}}),p={},r.bylines.forEach(function(e){var t=e.extension_id[".tag"];s(e.extension_id)&&(t=e.extension_id.app_id),p[t]=e.byline}),d=o.parseFeatureFlags(r.stormcrow_assignments),this.loaded=!0,[2,{appActionsEnabled:!0,actionIdToAppAction:c,appActionAppIcons:u,bylines:p,categoryMapsByExt:l,featureFlags:d,sharingServiceInfo:a}];case 2:if(_=n.sent(),_.error&&"feature_gated"===_.error[".tag"])return this.loaded=!0,[2,this.state];throw _;case 3:return[2]}})})},e.prototype.getSharingServiceInfo=function(){return n.__assign({},this.state.sharingServiceInfo)},e.prototype.refreshSharingServiceInfo=function(e){return n.__awaiter(this,void 0,Promise,function(){var t,i,r;return n.__generator(this,function(o){switch(o.label){case 0:if(void 0!==this.sharingServiceReq)return[2,this.sharingServiceReq];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.client.ns("profile_services").rpc("list_services",void 0,{subjectUserId:e})];case 2:return t=o.sent(),i={},t.services.forEach(function(e){switch(e.service_type[".tag"]){case"slack_dropbox":i.slack_dropbox=e;break;case"zoom":i.zoom=e}}),this.state=n.__assign({},this.state,{sharingServiceInfo:i}),[2,i];case 3:return r=o.sent(),this.sharingServiceReq=void 0,[2,{}];case 4:return[2]}})})},e})();t.Client=_;var f;t.getExtensionsClient=p}),define("modules/clean/react/extensions/feature_flags",["require","exports"],function(e,t){"use strict";function n(){var e=[];for(var t in r)if(r.hasOwnProperty(t)){var n=t;e.push([n,r[n]])}return e}function i(e){var t={};return n().forEach(function(n){var i=n[0],r=n[1],o=e[r];void 0!==o&&(t[i]=o)}),t}Object.defineProperty(t,"__esModule",{value:!0});var r={testFlag:"test_gated_feature",expBigTooltipText:"extensions_edu_tooltip_text",expSplitShareBtn:"extensions_split_share_btn",expGmailAction:"extensions_gmail_action",expWhatsAppAction:"extensions_whats_app_action",expOutlookAction:"extensions_outlook_action",expCommAppValue:"extensions_comm_app_value",expDownloadIntercept:"extensions_download_intercept",expUploadIntercept:"extensions_upload_intercept",expSurveyIntercept:"extensions_survey_intercept",expPersonalization:"extensions_personalization"};t.parseFeatureFlags=i}),define("modules/clean/react/extensions/file",["require","exports","modules/clean/filepath"],function(e,t,n){"use strict";function i(e){return void 0!==e.ext}function r(e){return void 0!==e.fq_path}function o(e){return void 0!==e.filename}function a(e){return i(e)?e.ext:r(e)?"."+n.file_extension(n.filename(e.fq_path)):o(e)?"."+n.file_extension(e.filename):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.hasExt=i,t.hasFqPath=r,t.hasFilename=o,t.getFileExt=a});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};define("modules/clean/react/extensions/split_share_button",["require","exports","modules/clean/react/async/loadable"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SplitShareButton=n.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/extensions/split_share_button_component"],t,n)}).then(__importStar).then(function(e){return e.SplitShareButton})}})}),define("modules/clean/react/extensions/tooltips",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";function i(e){switch(e){case"open_with_edu":return{".tag":e};case"split_share_edu":return{".tag":e};case"edit_experiment_image":return{".tag":e};case"edit_experiment_pdf":return{".tag":e};case"download_intercept_image":return{".tag":e};case"download_intercept_pdf":return{".tag":e};case"upload_intercept_image":return{".tag":e};case"upload_intercept_pdf":return{".tag":e};case"desktop_notification":return{".tag":e};case"other":return{".tag":e}}}function r(e,t){return a.filter(function(n){return o[n]({extensionsConfig:e,fileExt:t})})}Object.defineProperty(t,"__esModule",{value:!0}),t.tooltipFromName=i;var o={open_with_edu:function(e){return e.extensionsConfig.actionCategories.length>0},split_share_edu:function(e){return"ON"===e.extensionsConfig.featureFlags.expSplitShareBtn},download_intercept_image:function(e){var t=e.extensionsConfig,n=e.fileExt;return t.actionCategories.length>0&&"ON"===t.featureFlags.expDownloadIntercept&&[".jpg",".png",".jpeg"].indexOf(n)!==-1},download_intercept_pdf:function(e){var t=e.extensionsConfig,n=e.fileExt;return t.actionCategories.length>0&&"ON"===t.featureFlags.expDownloadIntercept&&".pdf"===n},upload_intercept_image:function(e){var t=e.extensionsConfig,n=e.fileExt;return t.actionCategories.length>0&&"ON"===t.featureFlags.expUploadIntercept&&[".jpg",".png",".jpeg"].indexOf(n)!==-1},upload_intercept_pdf:function(e){var t=e.extensionsConfig,n=e.fileExt;return t.actionCategories.length>0&&"ON"===t.featureFlags.expUploadIntercept&&".pdf"===n},edit_experiment_pdf:function(){return!1},edit_experiment_image:function(){return!1},desktop_notification:function(){return!1},other:function(){return!1}},a=["open_with_edu","split_share_edu","upload_intercept_pdf","upload_intercept_image","download_intercept_pdf","download_intercept_image","desktop_notification"];t.allowedTooltipsForConfig=r;(function(e){e.TOOLTIP_CONFIGS={open_with_edu:{tooltipTitle:n._("Do more with your files"),tooltipMessage:n._("Work on this file in other apps. Updates you make will automatically save back to Dropbox.")},download_intercept_pdf:{tooltipTitle:n._("No need to download"),tooltipMessage:n._("Edit, annotate, fax, or sign PDFs in your browser.")},upload_intercept_pdf:{tooltipTitle:n._("Move things forward"),tooltipMessage:n._("Sign, send, edit, and annotate PDFs in your browser.")}},e.EDU_SPLIT_SHARE_MAP={CONTROL:{tooltipTitle:n._("Extend the power of Dropbox"),tooltipMessage:n._("Now you can send files to Slack or present in Zoom without leaving Dropbox.")}}})(t.EduTooltipExperiment||(t.EduTooltipExperiment={}))}),define("modules/clean/react/extensions/utils",["require","exports","tslib"],function(e,t,n){"use strict";function i(e,n){return!n.is_dir&&(t.isSlackAvailable(e.sharingServiceInfo)||t.isZoomAvailable(e.sharingServiceInfo))&&!!e.featureFlags.expSplitShareBtn&&("ON"===e.featureFlags.expSplitShareBtn||"ON_SHOW_INVITE"===e.featureFlags.expSplitShareBtn)}function r(e,n){return!n.is_dir&&(t.isSlackAvailable(e.sharingServiceInfo)||t.isZoomAvailable(e.sharingServiceInfo))&&!!e.featureFlags.expSplitShareBtn&&"CONTROL"===e.featureFlags.expSplitShareBtn}function o(e,t){return t in e&&"enabled"===e[t].service_availability[".tag"]}function a(e,t){return t in e&&"is_connected"===e[t].connection_state[".tag"]}function s(e,t){return new Promise(function(n){return t({user:e,onRefresh:n})})}function c(t,i,r,o,c){return n.__awaiter(this,void 0,Promise,function(){var u,l,p,d,_,f,g,h,m,E,S,v,I;return n.__generator(this,function(x){switch(x.label){case 0:return a(i,o)?[2,!0]:[4,new Promise(function(t,n){e(["modules/clean/integrations/link_service"],t,n)}).then(n.__importStar)];case 1:return u=x.sent().linkService,[4,new Promise(function(t,n){e(["modules/clean/integrations/log_event"],t,n)}).then(n.__importStar)];case 2:return l=x.sent().createIntegrationsActionsLogger,[4,new Promise(function(t,n){e(["deep-integrations/platform/log_event"],t,n)}).then(n.__importStar)];case 3:return p=x.sent().withDefaults,[4,new Promise(function(t,n){e(["deep-integrations/instrumentation/common_context"],t,n)}).then(n.__importStar)];case 4:return d=x.sent().getCommonContextExtra,[4,new Promise(function(t,n){e(["deep-integrations/instrumentation/constants"],t,n)}).then(n.__importStar)];case 5:return _=x.sent().InstrConnectServiceFlowOutcome,[4,new Promise(function(t,n){e(["deep-integrations/instrumentation/connect_service_flow_wrapper"],t,n)}).then(n.__importStar)];case 6:f=x.sent(),g=f.buildEndEvent,h=f.buildStartEvent,m=p(l().logEvent,{extra:d({serviceList:Object.keys(i).map(function(e){return i[e]})})}),E=i[o],E&&m(h(E,c,_.Connected)),x.label=7;case 7:return x.trys.push([7,10,,11]),[4,u(t.id,o)];case 8:return x.sent(),[4,s(t,r)];case 9:return S=x.sent(),v=a(S,o),E&&m(v?g(E,c,_.Connected,_.Connected):g(E,c,_.Connected,_.Error)),[2,v];case 10:throw I=x.sent(),E&&m(g(E,c,_.Connected,_.Error,{error:JSON.stringify(I)})),I;case 11:return[2]}})})}function u(e,t,n,i,r,o){c(e,t,n,"zoom",o).then(function(e){e&&r(i)})}function l(t,i,r,o,a){var s=this;c(t,i,r,"slack_dropbox",a).then(function(i){return n.__awaiter(s,void 0,void 0,function(){var r;return n.__generator(this,function(a){switch(a.label){case 0:return i?[4,new Promise(function(t,n){e(["modules/clean/integrations/send_to_slack"],t,n)}).then(n.__importStar)]:[3,2];case 1:r=a.sent().showSendToSlackModal,r(t,o),a.label=2;case 2:return[2]}})})})}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowSplitShare=i,t.shouldShowOpenWithShare=r,t.isSlackAvailable=function(e){return o(e,"slack_dropbox")},t.isZoomAvailable=function(e){return o(e,"zoom")},t.presentInZoomFlow=u,t.shareInSlackFlow=l});
//# sourceMappingURL=pkg-extensions.min.js-vfltHYSYJ.map